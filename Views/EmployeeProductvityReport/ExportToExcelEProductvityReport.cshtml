@model TuvVision.Models.EmployeeProductvityReport
@using NonFactors.Mvc.Grid;
@using System.Web.Mvc;
@{
    ViewBag.Title = "ExportToExcelEProductvityReport";
    Layout = "~/Views/Shared/_TuvVision.cshtml";
}
<link href="~/AllJsAndCss/css/MVCGridN.css" rel="stylesheet" />

@*...Calender Control...*@
<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
<script src="//code.jquery.com/jquery-1.10.2.js"></script>
<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>


@*Ashwini Scripts here for datatable starts here*@
<script type="text/javascript" language="javascript" src="~/AllJsAndCss/datatable/js/jquery.dataTables.js"></script>

<!--export to excel-->
<script type="text/javascript" language="javascript" src="~/AllJsAndCss/js/dataTables.buttons.min.js"></script>
<script type="text/javascript" language="javascript" src="~/AllJsAndCss/js/jszip.min.js"></script>
<script type="text/javascript" language="javascript" src="~/AllJsAndCss/js/buttons.html5.min.js"></script>
<script src="~/AllJsAndCss/js/datatable-custom2.js"></script>
@*Ashwini Scripts here for datatable ends here*@


@using (Html.BeginForm("ExportToExcelEProductvityReport", "EmployeeProductvityReport", FormMethod.Post, new { enctype = "multipart/form-data", @id = "form1" }))
{
    <div class="main-content3 xs-max-height grey-bg-f3">
        <div class="grey-bg-f3">
            <!--Start of header-->
            <div class="container-fluid">
                <div class="row assignfixedwidth rp-5">
                    <div class="col-xs-12 form-col">
                        <div class="row">
                            <div class="col-xs-12">
                                <div class="white-bg section-box-shadow">
                                    <h3 class="form-page-title">Employee Productivity Report</h3>
                                    <div class="row">
                                        <div class="col-xs-12 col-sm-offset-1 col-sm-10">
                                            <div class="form-box">
                                                <form>
                                                    <div class="row">
                                                        <div class="col-xs-12 col-sm-12">
                                                            <button type="button" value="ExportToExcel" class="btn btn-info dynamic-function-btn dynamic-function-btn-2" onclick="location.href='@Url.Action("ExportIndex","EmployeeProductvityReport")'">
                                                                Export To Excel
                                                            </button>
                                                        </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-xs-12 col-sm-3">
                                                                <div class="form-group">
                                                                    <label>From Date:</label>
                                                                    @*@Html.TextBoxFor(model => model.StartDate, htmlAttributes: new { placeholder = "Start Date", @class = "form-control form-control-custom ", autocomplete = "off" })*@
                                                                    @Html.TextBoxFor(model => model.FromDate, "{0:dd/MMMM/yyyy}", htmlAttributes: new { placeholder = "Select From Date", @class = "form-control form-control-custom FromDate", autocomplete = "off" })
                                                                    @Html.ValidationMessageFor(model => model.FromDate, "", new { @class = "text-danger validation-msg" })
                                                                </div>
                                                            </div>
                                                            <div class="col-xs-12 col-sm-3">
                                                                <div class="form-group">
                                                                    <label>To Date:</label>
                                                                    @Html.TextBoxFor(model => model.ToDate, "{0:dd/MMMM/yyyy}", new { @placeholder = "Select To Date", @class = "form-control form-control-custom ToDate", autocomplete = "off" })
                                                                    @Html.ValidationMessageFor(model => model.ToDate, "", new { @class = "text-danger validation-msg" })
                                                                </div>
                                                            </div>

                                                            <div class="col-xs-12 col-sm-3">
                                                                <div class="form-group">
                                                                    <label>Inspector:</label>
                                                                    @{

                                                                    if (ViewBag.Inspector != null)
                                                                    {
                                                                @Html.DropDownListFor(model => model.InspectorID, new SelectList(@ViewBag.Inspector, "Code", "Name"), "---Select Inspector ID---", new { @id = "ddlInspectType", @class = "form-control" })
                                                                    }
                                                                    }
                                                                </div>
                                                            </div>
                                                            <div class="col-xs-12 col-sm-3">
                                                                <div class="form-group">
                                                                    <label>Branch Name:</label>
                                                                    @{

                                                                    if (ViewBag.Branch != null)
                                                                    {
                                                                       @Html.DropDownListFor(model => model.BranchName, new SelectList(@ViewBag.Branch, "Code", "Name"), "---Select Branch Name---", new { @id = "ddlBranchNameType", @class = "form-control" })
                                                                    }
                                                                    }
                                                                </div>
                                                            </div>

                                                        </div>


                                                        <div class="row">
                                                            <div class="col-xs-12 col-sm-12">
                                                                
                                                            </div>
                                                            <div class="col-xs-12 col-sm-4">

                                                                <div class="form-group">

                                                                    <button type="submit" class="btn btn-default insert-form-btn" id="btnExportToReport"> Generate Employee Productivity Report </button>


                                                                </div>
                                                            </div>
                                                            <div class="col-xs-12 col-sm-4">
                                                            </div>
                                                        </div>






                                                        <div class="col-xs-12">
                                                            @*<table id="example" class="display" cellspacing="0" width="100%">
                                                                <thead>
                                                                    <tr>
                                                                        <th>Branch Name</th>
                                                                        <th>Location Name</th>
                                                                        <th>Employee Name</th>
                                                                        <th>TPI                     </th>
                                                                        <th>PED                     </th>
                                                                        <th>ASME                    </th>
                                                                        <th>Energy                  </th>
                                                                        <th>Others                  </th>
                                                                        <th>Railway                 </th>
                                                                        <th>IBR                     </th>
                                                                        <th>Expediting Services    </th>
                                                                        <th>TRCU                    </th>
                                                                        <th>PESO                    </th>
                                                                        <th>PNGRB                   </th>
                                                                        <th>Vendor Evaluation        </th>
                                                                        <th>Design Appraisal       </th>
                                                                        <th>Asset Integrity         </th>
                                                                        <th>Quantity Verification   </th>
                                                                        <th>Renewable               </th>
                                                                        <th>Nuclear                 </th>
                                                                        <th>Conventional Power Plant</th>
                                                                        <th>Total Count              </th>
                                                                        <th>Activity Type            </th>
                                                                        <th>Total Hours Count         </th>
                                                                        <th>Leve Count               </th>

                                                                    </tr>
                                                                </thead>

                                                                <tbody>

                                                                    <tr class="hidden">
                                                                        <td>Branch Name</td>
                                                                        <td>Location Name</td>
                                                                        <td>Employee Name</td>
                                                                        <td>TPI                     </td>
                                                                        <td>PED                     </td>
                                                                        <td>ASME                    </td>
                                                                        <td>Energy                  </td>
                                                                        <td>Others                  </td>
                                                                        <td>Railway                 </td>
                                                                        <td>IBR                     </td>
                                                                        <td>Expediting Services    </td>
                                                                        <td>TRCU                    </td>
                                                                        <td>PESO                    </td>
                                                                        <td>PNGRB                   </td>
                                                                        <td>Vendor Evaluation        </td>
                                                                        <td>Design Appraisal       </td>
                                                                        <td>Asset Integrity         </td>
                                                                        <td>Quantity Verification   </td>
                                                                        <td>Renewable               </td>
                                                                        <td>Nuclear                 </td>
                                                                        <td>Conventional Power Plant</td>
                                                                        <td>Total Count              </td>
                                                                        <td>Activity Type            </td>
                                                                        <td>Total Hours Count         </td>
                                                                        <td>Leve Count               </td>


                                                                    </tr>

                                                                    @if (ViewData["EmployeeProductvityReport"] !=null)
{
    foreach (var b in ViewData["EmployeeProductvityReport"] as IEnumerable<TuvVision.Models.EmployeeProductvityReport>)
    {
                                                                <tr>
                                                                    <td>@b.BranchName</td>
                                                                    <td>@b.Location_Name</td>
                                                                    <td>@b.InspectorID</td>
                                                                    <td>@b.TPI                     </td>
                                                                    <td>@b.PED                     </td>
                                                                    <td>@b.ASME                    </td>
                                                                    <td>@b.Energy                  </td>
                                                                    <td>@b.OTHERS                  </td>
                                                                    <td>@b.RAILWAY                 </td>
                                                                    <td>@b.IBR                     </td>
                                                                    <td>@b.EXPEDITING_SERVICES     </td>
                                                                    <td>@b.TRCU                    </td>
                                                                    <td>@b.PESO                    </td>
                                                                    <td>@b.PNGRB                   </td>
                                                                    <td>@b.VENDOR_EVALUATION       </td>
                                                                    <td>@b.DESIGN_APPRAISAL        </td>
                                                                    <td>@b.ASSET_INTEGRITY         </td>
                                                                    <td>@b.QUANTITY_VERIFICATION   </td>
                                                                    <td>@b.RENEWABLE               </td>
                                                                    <td>@b.NUCLEAR                 </td>
                                                                    <td>@b.CONVENTIONAL_POWER_PLANT</td>
                                                                    <td>@b.TotalCount              </td>
                                                                    <td>@b.ActivityType            </td>
                                                                    <td>@b.TotalHoursCount         </td>
                                                                    <td>@b.LeveCount               </td>

                                                                </tr>
                                                                }
                                                                }
                                                                </tbody>


                                                            </table>*@

                                                        </div>

                                                        <div class="col-xs-12">
                                                            <table class="display dataTable no-footer" style="overflow-y:auto" id="gridMapping">
                                                                <tr>
                                                                    <td>
                                                                        @(Html
                            .Grid(Model.lst1)
                            .Build(columns =>
                            {

                                columns.Add(c => c.BranchName).Titled("Branch Name");
                                columns.Add(c => c.Location_Name).Titled("Location Name");
                                columns.Add(c => c.InspectorID).Titled("Employee Name");
                                columns.Add(c => c.TPI).Titled("TPI");
                                columns.Add(c => c.PED).Titled("PED");
                                columns.Add(c => c.ASME).Titled("ASME");
                                columns.Add(c => c.Energy).Titled("Energy");
                                columns.Add(c => c.OTHERS).Titled("Others");
                                columns.Add(c => c.RAILWAY).Titled("Railway");
                                columns.Add(c => c.IBR).Titled("IBR");
                                columns.Add(c => c.EXPEDITING_SERVICES).Titled("Expediting Services    ");
                                columns.Add(c => c.TRCU).Titled("TRCU");
                                columns.Add(c => c.PESO).Titled("PESO");
                                columns.Add(c => c.PNGRB).Titled("PNGRB");
                                columns.Add(c => c.VENDOR_EVALUATION).Titled("Vendor Evaluation");
                                columns.Add(c => c.DESIGN_APPRAISAL).Titled("Design Appraisal");
                                columns.Add(c => c.ASSET_INTEGRITY).Titled("Asset Integrity");
                                columns.Add(c => c.QUANTITY_VERIFICATION).Titled("Quantity Verification");
                                columns.Add(c => c.RENEWABLE).Titled("Renewable");
                                columns.Add(c => c.NUCLEAR).Titled("Nuclear");
                                columns.Add(c => c.CONVENTIONAL_POWER_PLANT).Titled("Conventional Power Plant");
                                columns.Add(c => c.TotalCount).Titled("Total Count");
                                columns.Add(c => c.ActivityType).Titled("Activity Type");
                                columns.Add(c => c.TotalHoursCount).Titled("Total Hours Count");
                                columns.Add(c => c.LeveCount).Titled("Leve Count");
                            })
                            .Pageable(pager =>
                            {
                                //pager.PageSizes = new DictionaryInt32, String > { { 0, "All" }, { 2, "2" }, { 4, "4" } };
                                pager.ShowPageSizes = true;
                                pager.PagesToDisplay = 3;
                                pager.CurrentPage = 1;
                                pager.RowsPerPage = 2;
                            })
                            .UsingFilterMode(GridFilterMode.Row)
                            .Empty("No data found")
                            .Filterable()
                            .Sortable()

                                                                        )


                                                                    </td>
                                                                </tr>
                                                            </table>



                                                        </div>

                                                        <div class="row">
                                                            @if (Convert.ToString(TempData["Result"]) != null && Convert.ToString(TempData["Result"]) != "")
                                                            {
                                                                <div style="color:red; text-align:center;">
                                                                    <p style="color:red;">@Convert.ToString(TempData["Result"])</p>
                                                                </div>
                                                            }
                                                        </div>

</form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
                                                                    }




<script>

    if(@Model==null)
    {
        if('@Convert.ToString(TempData["Result"])'!='')
        {
            alert('@Convert.ToString(TempData["Result"])');
        }
    }
</script>



<script>
    $(function () {
        $(".FromDate").datepicker({
            dateFormat: 'dd/MM/yy',//check change
            changeMonth: true,
            changeYear: true,
            yearRange: "-100:+50"
        });
    });
</script>
<script>
    $(function () {
        $(".ToDate").datepicker({
            dateFormat: 'dd/MM/yy',//check change
            changeMonth: true,
            changeYear: true,
            yearRange: "-100:+50"
        });
    });
</script>
<script type="text/javascript">
    $(document).ready(function myfunction() {
        @*@{
            string count = Convert.ToString(TempData["Count"]);//Value Received in Tempdata and Store in Count Variable

            if (count != null)
            {
                if (count != "0" && count != "")
                {
                    //Display Download Link
               @: $("#td_heading").css("display", "");
            }
                else
                {
                    //Hide Download Link
               @: $("#td_heading").css("display", "none");

                }

            }
    }*@

        $("#btnExportToReport").click(function myfuuction() {
            var ddlInspector = $("#ddlInspectType").val();
            if ($("#FromDate").val() == "") {
                alert('Select FromDate!');
                return false;
            }
            if ($("#ToDate").val() == "") {
                alert('Select ToDate!');
                return false;
            }
            debugger;
            if ($("#FromDate").val() > $("#ToDate").val()) {
                alert("ToDate Selected is Greater than FromDate  !!!");
                return false;
            }
                //if ($("#ddlInspectType")[0].selectedIndex == 0) {
                //    debugger;
                //    alert("Please select Inspector ID...!!!");
                //    $("#ddlInspectType").focus();
                //    return false;
                //}
            else {
                return true;
            }
        });

    });
</script>

<script>
           [].forEach.call(document.getElementsByClassName('mvc-grid'), function (element) {
               new MvcGrid(element);
           });
</script>
