@model TuvVision.Models.DocumentRevieweModel

@{
    ViewBag.Title = "DocumentReviewed";
    Layout = "~/Views/Shared/_TuvVision.cshtml";
}

<script type="text/javascript" language="javascript" src="~/AllJsAndCss/datatable/js/jquery.dataTables.js"></script>
<script src="~/AllJsAndCss/datatable/js/jquery.dataTables.js"></script>
<script src="~/AllJsAndCss/js/datatable-custom.js"></script>
<div class="white-bg section-box-shadow">

    <div class="row">
        <div class="col-xs-12 col-sm-offset-1 col-sm-10">
            <br />
            <div class="col-xs-12">
                <h3 class="dynamic-page-title dynamic-page-title-2  ">Inspection Release Note : @Session["IRNReport"]</h3>
                <br />
                
                @if (Model != null)
            {
                if (Model.PK_IVR_ID != 0)
                {
                        <button class="btn btn-default news-btn" type="button" onclick="location.href='@Url.Action("IRNForm", "InspectionReleaseNote",new { @PK_IVR_ID = Model.PK_IVR_ID, @PK_RM_ID=Model.abcid} )'">General</button>
                        <button class="btn btn-default news-btn" type="button" onclick="location.href='@Url.Action("ItemDescription", "InspectionReleaseNote",new { @PK_IVR_ID = Model.PK_IVR_ID, @PK_RM_ID=Model.abcid} )'">Item Description</button>
                        <button class="btn btn-default news-btn" type="button" onclick="location.href='@Url.Action("ReferenceDocuments", "InspectionReleaseNote",new { @PK_IVR_ID = Model.PK_IVR_ID, @PK_RM_ID=Model.abcid} )'">Reference Documents</button>
                        <button class="btn btn-default news-btn" type="button" onclick="location.href='@Url.Action("InspectionActivites", "InspectionReleaseNote",new { @PK_IVR_ID = Model.PK_IVR_ID, @PK_RM_ID=Model.abcid} )'">Stage Witnessed</button>
                        <button class="btn btn-default insert-form-btn" type="button" onclick="location.href='@Url.Action("DocumentReviewed", "InspectionReleaseNote",new { @PK_IVR_ID = Model.PK_IVR_ID, @PK_RM_ID=Model.abcid} )'">Document Reviewed</button>
                        <button class="btn btn-default news-btn" type="button" onclick="location.href='@Url.Action("Conclusion", "InspectionReleaseNote",new { @PK_IVR_ID = Model.PK_IVR_ID, @PK_RM_ID=Model.abcid} )'">Conclusion</button>
                        @*<button class="btn btn-info dynamic-function-btn" type="button" onclick="location.href='@Url.Action("EquipmentDetails", "InspectionReleaseNote",new { @PK_IVR_ID = Model.PK_IVR_ID} )'">Details Of Equipment</button>*@
                        <button class="btn btn-default news-btn" type="button" onclick="location.href='@Url.Action("AllConcern", "InspectionReleaseNote",new { @PK_IVR_ID = Model.PK_IVR_ID, @PK_RM_ID=Model.abcid} )'">List Of Open Issues</button>
                        @*<button class="btn btn-info dynamic-function-btn" type="button" onclick="location.href='@Url.Action("IvrReports", "InspectionReleaseNote",new { @PK_IVR_ID = Model.PK_IVR_ID} )'">Report</button>*@
                        <button class="btn btn-default news-btn" type="button" onclick="location.href='@Url.Action("EarlierIssuedQuantity", "InspectionReleaseNote",new { @PK_IVR_ID = Model.PK_IVR_ID, @PK_RM_ID=Model.abcid} )'">Earlier Issued Quantity</button>

                         @*<a href="@Url.Action("IRNForm", "InspectionReleaseNote",new { @PK_IVR_ID = Model.PK_IVR_ID, @PK_RM_ID=Model.abcid} )" class="btn btn-default news-btn" style="float:right;"><i class="fa fa-long-arrow-left"></i> Go Back</a>*@
                    }
                }


            </div>
            <div class="col-xs-12">
                <div class="white-bg section-box-shadow">
                    <h3 class="form-page-title">Document Reviewed</h3>
                    <div class="row">
                        <div class="col-xs-12 col-sm-offset-1 col-sm-10">

                            <div class="form-box">
                                <form method="post" enctype="multipart/form-data">
                                    @Html.HiddenFor(m => m.PK_IVR_ID)
                                    @Html.HiddenFor(m => m.abcid)
                                    @Html.HiddenFor(m => m.PK_DR_ID)

                                    <div class="row">
                                        <div class="col-xs-12 col-sm-12">
                                            <div class="form-group">
                                                <label>Document Reviewed:</label>
                                                <br />
                                                <span style="color:#E12F24;">
                                                    <strong> &nbsp;Note : </strong>
                                                </span>
                                                Statement shall give clear idea to customer of performed activity <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(i.e. QAP Stage No.  - Inspection activity carried out - findings).
                                                <br />
                                                @Html.TextAreaFor(model => model.Description, new { @placeholder = "Description", @class = "form-control", @rows = 6 })
                                                @Html.ValidationMessageFor(model => model.Description, "", new { @class = "text-danger validation-msg" })
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xs-12 text-center" id="IRNPointerEvents">
                                        <button type="submit" class="btn btn-default insert-form-btn">Save </button>
                                    </div>
                                    @*added by satish yadav for showing autosuggestion message*@
                                    <div id="suggestions-container" class="suggestions"></div>
                                    @*end here autosuggestion message*@
                                </form>
                            </div>

                        </div>
                    </div>
                    <!--Contact Details By Manoj -->
                    <div class="row">
                        @*<div class="col-xs-12 col-sm-offset-1 col-sm-10">*@
                        <div class="col-xs-12 col-sm-12">
                            <div class="col-xs-12">
                                <table id="example" class="display custom-table" cellspacing="0" width="100%">

                                    <thead>
                                        <tr>
                                            <th class="remove-search" width="5%">Sr. No</th>
                                            <th class="remove-search" width="90%">Document Reviewed</th>

                                            <th class="remove-search" width="5%">Action</th>
                                        </tr>
                                    </thead>

                                    <tbody>

                                        @{
                                            int k = 0;
                                        }
                                        @foreach (var item in ViewData["CostSheet"] as IEnumerable<TuvVision.Models.DocumentRevieweModel>)
                                        {
                                            k = k + 1;
                                            <tr>

                                                <td width="5%">@k</td>
                                                <td style='white-space: pre-line;' width="90%">@item.Description</td>

                                                <td class="less-width" width="5%">
                                                    <a href="@Url.Action("DocumentReviewed", "InspectionReleaseNote", new { @PK_DR_ID = item.PK_DR_ID, @PK_RM_ID = Model.abcid })" title="Edit"><span class="fa fa-pencil"></span>&nbsp;</a>
                                                    <a href="@Url.Action("DeleteDocumentReviewedData", "InspectionReleaseNote", new { @PK_DR_ID = item.PK_DR_ID, @PK_RM_ID = Model.abcid })" onclick="return confirm('Are you sure you want to Delete this Record?')" title="Delete"><span class="fa fa-trash-o"></span>&nbsp;</a>
                                                    @{
                                                        if ((Convert.ToString(TempData["InsertCompany"])) != "" && Convert.ToString(TempData["InsertCompany"]) != null)
                                                        {
                                                            TempData["InsertCompany"] = null;
                                                            @*<script type="text/javascript" language="javascript">
                                            alert("Document Review Added Successfully!!!!");
                                                            </script>*@
                                                        }
                                                        if ((Convert.ToString(TempData["UpdateCompany"])) != "" && Convert.ToString(TempData["UpdateCompany"]) != null)
                                                        {
                                                            TempData["UpdateCompany"] = null;
                                                            @*<script type="text/javascript" language="javascript">
                                            alert("Document Review Updated Successfully");
                                                            </script>*@
                                                        }
                                                    }
                                                </td>

                                            </tr>
                                                        }

                                    </tbody>

                                </table>
                            </div>
                        </div>
                    </div>

                </div><!-- /.box-shadow -->
            </div><!-- /.col -->
        </div>
    </div>
<!--Contact Details By Manoj -->
</div><!-- /.box-shadow -->


@*<div class="main-content3 xs-max-height">
    <br>
    <br>
    <!--Start of header-->
    <div class="container-fluid">
        @*<div class="row assignfixedwidth rp-15">

                <h3 class="form-page-title">Document Reviewed</h3>
                <div class="col-xs-12">
                    <hr class="custom-hr">
                </div><!-- /.col -->
                <!--Table was here-->

            </div><!-- /.row -->

        <div class="col-xs-12">
            <table id="example" class="display custom-table" cellspacing="0" width="100%">

                <thead>
                    <tr>
                        <th class="remove-search">Sr. No</th>
                        <th class="remove-search">Document Reviewed</th>

                        <th class="remove-search">Action</th>
                    </tr>
                </thead>

                <tbody>

                    @{
                        int i = 0;
                    }
                    @foreach (var item in ViewData["CostSheet"] as IEnumerable<TuvVision.Models.DocumentRevieweModel>)
                    {
                        i = i + 1;
                        <tr>

                            <td>@i</td>
                            <td>@item.Description</td>

                            <td class="less-width">
                                <a href="@Url.Action("DocumentReviewed", "InspectionReleaseNote", new {@PK_DR_ID = item.PK_DR_ID })" title="Edit"><span class="fa fa-pencil"></span>&nbsp;</a>
                                <a href="@Url.Action("DeleteDocumentReviewedData", "InspectionReleaseNote", new {@PK_DR_ID = item.PK_DR_ID })" onclick="return confirm('Are you sure you want to Delete this Record?')" title="Delete"><span class="fa fa-trash-o"></span>&nbsp;</a>
                                @{
                                    if ((Convert.ToString(TempData["InsertCompany"])) != "" && Convert.ToString(TempData["InsertCompany"]) != null)
                                    {
                                        TempData["InsertCompany"] = null;
                                        <script type="text/javascript" language="javascript">
                                            alert("Document Review Added Successfully!!!!");
                                        </script>
                                    }
                                    if ((Convert.ToString(TempData["UpdateCompany"])) != "" && Convert.ToString(TempData["UpdateCompany"]) != null)
                                    {
                                        TempData["UpdateCompany"] = null;
                                        <script type="text/javascript" language="javascript">
                                            alert("Document Review Updated Successfully");
                                        </script>
                                    }
                                }
                            </td>

                        </tr>
                                    }

                </tbody>

            </table>
        </div><!-- /.data table col -->


    </div><!-- /.container-fluid -->


</div>*@


                                        }

<script>
    @*added by satish yadav for Autosuggestion*@
        $(document).ready(function () {
            const $textarea = $("#Description");
            const $suggestionsContainer = $("#suggestions-container");
            $textarea.on("input", function () {
                debugger;
                const query = $(this).val().toLowerCase();
                const id = $("#PK_IVR_ID").val();
                if (query) {
                    $.ajax({
                        url: '@Url.Action("GetSuggestions", "InspectionReleaseNote")',
                        data: { Searchres: query, PK_IVR_ID: id },
                        success: function (response) {
                            if (response.success) {
                                displaySuggestions(response.data);
                            } else {
                                console.error(response.error);
                            }
                        }
                    });
                }
                else
                {
                    $suggestionsContainer.empty();
                }
            });
            $suggestionsContainer.on("click", ".suggestion-item", function () {
                const text = $(this).text();
                $textarea.val(text);
                $suggestionsContainer.empty();
            });
            $(document).on("click", function (event) {
                if (!$(event.target).closest("#Description, #suggestions-container").length) {
                    $suggestionsContainer.empty();
                }
            });

            function displaySuggestions(items) {
                $suggestionsContainer.empty();
                items.forEach(item => {
                    const $suggestionItem = $("<p>").addClass("suggestion-item").text(item.Name);
                    $suggestionsContainer.append($suggestionItem);
                });
            }
        });
</script>
<style>
    .suggestions {
        border: 1px solid #ccc;
        max-height: 150px;
        overflow-y: auto;
        position: absolute;
        z-index: 1000;
        background-color: white;
    }

    .suggestion-item {
        padding: 10px;
        cursor: pointer;
        margin: 0;
    }

        .suggestion-item:hover {
            background-color: #f0f0f0;
        }
</style>
@*end here autosuggestion*@


<script>
    var isConfirmationIRN = @Session["IsConfirmationIRN"] ?? 0;
    // JavaScript to disable pointer events if isConfirmationIVR is 1

    if (isConfirmationIRN == 1) {
        document.getElementById("IRNPointerEvents").style.pointerEvents = "none";

    }
</script>