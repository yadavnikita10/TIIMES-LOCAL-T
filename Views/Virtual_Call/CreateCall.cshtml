@model TuvVision.Models.Calls

@{
    ViewBag.Title = "";
    Layout = "~/Views/Shared/_TuvVision.cshtml";
    List<string> EditProdName = ViewBag.EditproductName as List<string>;
}
<style>
    /*-- Delete color-profile --*/
    ul.Attachment {
        padding-left: 0px;
        list-style: none;
        margin-bottom: 0px;
    }

        ul.Attachment > li {
            border: 1px solid #999;
            margin: 7px 5px 0 0;
            display: inline-block;
            padding: 0px 10px;
            background-color: #dfdfdf;
            color: #000;
        }

            ul.Attachment > li a.title {
                color: #000;
                vertical-align: text-bottom;
                text-transform: capitalize;
            }

            ul.Attachment > li a.deleteItem {
                color: white;
                font-size: 10px;
                background: #e91e1e;
                padding: 2px 4px;
                border-radius: 50%;
                vertical-align: text-top;
            }
</style>
@*...Calender Control...*@
<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
<script src="//code.jquery.com/jquery-1.10.2.js"></script>
<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>


<script type="text/javascript" language="javascript" src="~/AllJsAndCss/datatable/js/jquery.dataTables.js"></script>

@*<script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-1.8.0.js"></script>
<script src="https://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.22/jquery-ui.js"></script>*@

@*<link href="~/Content/css/bootstrap-multiselect.css" rel="stylesheet" />
<script src="~/Scripts/bootstrap-multiselect.js"></script>*@

<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
<link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css" />
@*@{ 
    List<string> EditProdName =ViewBag.EditproductName as List<string>;
}*@



<!--multiselect-->
<link href="~/AllJsAndCss/css/bootstrap-multiselect.css" rel="stylesheet" />
<!--filepond-->
<link href="~/AllJsAndCss/css/filepond.css" rel="stylesheet" />

<script src="~/AllJsAndCss/datatable/js/jquery.dataTables.js"></script>

<script src="~/AllJsAndCss/js/datatable-custom.js"></script>

<script>

    $(function () {
        $(".CallRcvdate").datepicker({
            dateFormat: 'dd/mm/yy',//check change
            changeMonth: true,
            changeYear: true,
            yearRange: "-100:+50"
        });
    });

    $(function () {
        $(".PlannedDate").datepicker({
            dateFormat: 'dd/mm/yy',//check change
            changeMonth: true,
            changeYear: true,
            yearRange: "-100:+50"
        });
    });
</script>
<script>

    $(function () {
        $(".CallReqdate").datepicker({
            dateFormat: 'dd/mm/yy',//check change
            changeMonth: true,
            changeYear: true,
            yearRange: "-100:+50"
        });
    });
</script>
<style>
    .ui-widget-header {
        background: #001ED2 !important;
    }

    .ui-datepicker-month, .ui-datepicker-year {
        color: #333 !important;
    }
</style>

<div class="grey-bg-f3">
    <div class="container-fluid">
        <div class="row assignfixedwidth rp-5">

            <div class="col-xs-12 form-col">
                <div class="row">
                    <div class="col-xs-12 text-right">
                        <a href="@Url.Action("CallsDashBoard", "Virtual_Call")" class="btn btn-info dynamic-function-btn"><i class="fa fa-long-arrow-left"></i> Go Back</a>
                    </div>
                    <div class="col-xs-12">
                        <div class="white-bg section-box-shadow">

                                                        @*@if (Model.PK_Call_ID != 0)*@
                                                            @if (Model.PK_Call_ID == 0)
                                                            {
                                                              
                                                                    <h3 class="form-page-title">Create Add-On Call for Additional PO</h3>

                                                            }
                                                            else
                                                            {
                                                                <h3 class="form-page-title">
                                                                    @Html.DisplayFor(m => m.PK_Call_ID)
                                                                </h3>
                                                            }





                                                                <div class="row">
                                                                    <div class="col-xs-12 col-sm-offset-1 col-sm-10">
                                                                        <div class="form-box">
                                                                            <form method="post">
                                                                                <div class="col-xs-12 text-right">
                                                                                    <p style="padding:0;margin:0;margin-bottom:10px;color:#FB5F6B;font-weight:bold;font-size: 12px;">Fields marked * are mandatory</p>
                                                                                </div>
                                                                                <div class="col-xs-12 col-sm-4">
                                                                                    <div class="form-group">
                                                                                        <label>Customer Name:</label>
                                                                                        @Html.TextBoxFor(model => model.Company_Name, new { placeholder = "Enter Company Name", @class = "form-control form-control-custom CompanyName" })
                                                                                        @Html.ValidationMessageFor(model => model.Company_Name, "", new { @class = "text-danger" })
                                                                                    </div>
                                                                                </div>
                                                                                @*<div class="col-xs-12 col-sm-4">
                                                                <div class="form-group">
                                                                    <label>Status:</label>
                                                                    @Html.TextBoxFor(model => model.Status, new { placeholder = "Enter Status", @class = "form-control form-control-custom CompanyName" })
                                                                    @Html.ValidationMessageFor(model => model.Status, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>*@
                                                                                <div class="col-xs-12 col-sm-4">
                                                                                    <div class="form-group">
                                                                                        <label>PO Number:</label>
                                                                                        @Html.TextBoxFor(model => model.PO_Number, new { placeholder = "Enter PO Number", @class = "form-control form-control-custom" })
                                                                                        @*@Html.ValidationMessageFor(model => model.PO_Number, "", new { @class = "text-danger" })*@
                                                                                    </div>
                                                                                </div>
                                                                                <div class="col-xs-12 col-sm-4">
                                                                                    <div class="form-group">
                                                                                        <label>Customer Contact Person Name:</label>
                                                                                        @Html.TextBoxFor(model => model.Source, new { placeholder = "Enter Buyer Name", @class = "form-control form-control-custom CompanyName" })
                                                                                        @Html.ValidationMessageFor(model => model.Source, "", new { @class = "text-danger" })
                                                                                    </div>
                                                                                </div>


                                                                                @*<div class="col-xs-12 col-sm-4">
                                                                                                         <div class="form-group">
                                                                                                             <label>Urgency:</label>
                                                                                                             @Html.DropDownListFor(model => model.Urgency, new List<SelectListItem>
                                                            {
                                                                new SelectListItem {Text="---Select---",Value="---Select---" },
                                                                new SelectListItem {Text="High",Value="High" },
                                                                new SelectListItem {Text="Low",Value="Low" },
                                                                new SelectListItem {Text="Med-High",Value="Med-High" },
                                                                new SelectListItem {Text="Med-Low",Value="Med-Low" },
                                                                new SelectListItem {Text="Medium",Value="Medium" }
                                                            }, new { @class = "form-control" })
                                                                                                             @Html.ValidationMessageFor(model => model.Urgency, "", new { @class = "text-danger" })
                                                                                                         </div>
                                                                                                     </div>*@
                                                                                @*<div class="col-xs-12 col-sm-4">
                                                                                                         <div class="form-group">
                                                                                                             <label>Stages Of Inspection:</label>
                                                                                                             @Html.DropDownListFor(model => model.Sub_Category, new List<SelectListItem>
                                                            {
                                                                 new SelectListItem {Text="---Select---",Value="---Select---" },
                                                                new SelectListItem {Text="Kick off meeting",Value="Kick off meeting" },
                                                                new SelectListItem {Text="Pre inspection meeting",Value="Pre inspection meeting" },
                                                                new SelectListItem {Text="Stage Inspection",Value="Stage Inspection" },
                                                                new SelectListItem {Text="Final Inspection",Value="Final Inspection" },

                                                            }, new { @class = "form-control" })
                                                                                                             @Html.ValidationMessageFor(model => model.Sub_Category, "", new { @class = "text-danger" })
                                                                                                         </div>
                                                                                                     </div>*@
                                                                                <div class="col-xs-12 col-sm-4">
                                                                                    <div class="form-group">
                                                                                        <label>Vendor Contact Person Name:</label>
                                                                                        @Html.TextBoxFor(model => model.ContactName, new { placeholder = "Enter Contact Name", @class = "form-control form-control-custom CompanyName" })
                                                                                        @Html.ValidationMessageFor(model => model.ContactName, "", new { @class = "text-danger" })
                                                                                    </div>
                                                                                </div>
                                                                                <div class="col-xs-12 col-sm-4">
                                                                                    <div class="form-group">
                                                                                        <label>Call Received Date:</label>
                                                                                        @Html.TextBoxFor(model => model.Call_received_date, "{0:dd MMM yyyy}", new { placeholder = "Select Call Received Date", @class = "form-control form-control-custom CompanyName CallRcvdate" })
                                                                                        @Html.ValidationMessageFor(model => model.Call_received_date, "", new { @class = "text-danger" })
                                                                                    </div>
                                                                                </div>
                                                                                <div class="col-xs-12 col-sm-4">
                                                                                    <div class="form-group">
                                                                                        <label>Call Requested Date:</label>
                                                                                        @Html.TextBoxFor(model => model.Call_Request_Date, "{0:dd MMM yyyy}", new { placeholder = "Select Call Requested Date", @class = "form-control form-control-custom CompanyName CallReqdate" })
                                                                                        @Html.ValidationMessageFor(model => model.Call_Request_Date, "", new { @class = "text-danger" })
                                                                                    </div>
                                                                                </div>
                                                                                @*<div class="col-xs-12 col-sm-4">
                                                                <div class="form-group">
                                                                    <label>Type:</label>
                                                                    @Html.TextBoxFor(model => model.Type, new { placeholder = "Enter Type", @class = "form-control form-control-custom CompanyName" })
                                                                    @Html.ValidationMessageFor(model => model.Type, "", new { @class = "text-danger" })
                                                                </div>
                                                            </div>*@
                                                                                @*<div class="col-xs-12 col-sm-4">
                                                                                    <div class="form-group">
                                                                                        <label>Category:</label>
                                                                                        @Html.TextBoxFor(model => model.Category, new { placeholder = "Enter Category", @class = "form-control form-control-custom CompanyName" })
                                                                                        @Html.ValidationMessageFor(model => model.Category, "", new { @class = "text-danger" })
                                                                                    </div>
                                                                                </div>*@

                                                                                <div class="col-xs-12 col-sm-4">
                                                                                    <div class="form-group">
                                                                                        <label>Stages of Inspection:</label>
                                                                                        @Html.DropDownListFor(m => m.Category, new List<SelectListItem>
                                                          {
                                                            new SelectListItem{ Text="kick Off Meeting", Value = "kick Off Meeting" },
                                                            new SelectListItem{ Text="Pre inspection meeting", Value = "Pre inspection meeting" },
                                                            new SelectListItem{ Text="Stage Inspection", Value = "Stage Inspection" },
                                                            new SelectListItem{ Text="Final Inspection", Value = "Final Inspection" },
                                                         }, "- Select Category -", new { @class = "form-control", /*@id = "Type"*/ })
                                                                                        @*@Html.ValidationMessageFor(m => m.Category, "", new { @class = "text-danger" })*@
                                                                                    </div>
                                                                                </div>


                                                                                <div class="col-xs-12 col-sm-4">
                                                                                    <div class="form-group">
                                                                                        <label>Vendor Name:</label>
                                                                                        @Html.TextBoxFor(model => model.Vendor_Name, new { placeholder = "Enter Vendor Name", @class = "form-control form-control-custom CompanyName" })
                                                                                        @Html.ValidationMessageFor(model => model.Vendor_Name, "", new { @class = "text-danger" })
                                                                                    </div>
                                                                                </div>
                                                                                @*<div class="col-xs-12 col-sm-4">
                                                                                    <div class="form-group">
                                                                                        <label>Item to be inspected:</label>
                                                                                        <div class="drpdomn">

                                                                                        </div>
                                                                                    </div>
                                                                                </div>*@
                                                                                <div class="col-xs-12 col-sm-4">
                                                                                    <div class="form-group">
                                                                                        <label>Item to be Inspected:</label><span style="color:#ff0000;">*</span>
                                                                                        <div class="drpdomn" id="drpdomn">
                                                                                        </div>
                                                                                        @if (ViewBag.check == "productcheck")
                                                                                        {

                                                                                            <select id="ProductLists" class="form-control form-multiselect-city" multiple="multiple" name="ProductList" placeholder="Select Option" required="required">
                                                                                                @foreach (var item in ViewBag.ProjectTypeItems)
                                                                                                {
                                                                                                    if (EditProdName.Contains(item.Text))
                                                                                                    {
                                                                                                        <option value="@item.Value" selected>@item.Text</option>
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        <option value="@item.Value">@item.Text</option>
                                                                                                    }

                                                                                                }
                                                                                            </select>
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            <select id="ProductLists" class="form-control form-multiselect-city" multiple="multiple" name="ProductList" placeholder="Select Option" required="required">

                                                                                                @{
                                                                                                    foreach (var item in ViewData["Drpproduct"] as IEnumerable<TuvVision.Models.Calls>)
                                                                                                    {

                                                                                                        <option value="@item.Product_Name">@item.Product_Name&nbsp; &nbsp;</option>


                                                                                                    }
                                                                                                }
                                                                                            </select>
                                                                                                    }

                                                                                        @Html.ValidationMessageFor(model => model.ProductList, "", new { @class = "text-danger" })

                                                                                    </div>




                                                                                    <input type="text" class="hidden" id="ProductLists" />
                                                                                </div>
                                                                                <div class="col-xs-12">
                                                                                    <div class="form-group">
                                                                                        <label>Project Name:</label>
                                                                                        @Html.TextAreaFor(model => model.Project_Name, new { placeholder = "Enter Project Name", @class = "form-control form-control-custom", @rows = "3" })
                                                                                        @Html.ValidationMessageFor(model => model.Project_Name, "", new { @class = "text-danger" })
                                                                                    </div>
                                                                                </div>
                                                                                <div class="col-xs-12">
                                                                                    <div class="form-group">
                                                                                        <label>Inspection Location:</label>
                                                                                        @Html.TextAreaFor(model => model.Job_Location, new { placeholder = "Enter Job Location", @class = "form-control form-control-custom", @rows = "3" })
                                                                                        @Html.ValidationMessageFor(model => model.Job_Location, "", new { @class = "text-danger" })
                                                                                    </div>
                                                                                </div>
                                                                                <div class="col-xs-12 col-sm-4">
                                                                                    <div class="form-group">
                                                                                        <label>Customer Email ID:</label>
                                                                                        @Html.TextBoxFor(model => model.Client_Email, new { placeholder = "Enter Client Email", @class = "form-control form-control-custom CompanyName" })
                                                                                        @Html.ValidationMessageFor(model => model.Client_Email, "", new { @class = "text-danger" })

                                                                                    </div>
                                                                                </div>
                                                                                <div class="col-xs-12 col-sm-4">
                                                                                    <div class="form-group">
                                                                                        <label>Vendor Email ID:</label>
                                                                                        @Html.TextBoxFor(model => model.Vendor_Email, new { placeholder = "Enter Vendors Email", @class = "form-control form-control-custom CompanyName" })
                                                                                        @Html.ValidationMessageFor(model => model.Vendor_Email, "", new { @class = "text-danger" })
                                                                                    </div>
                                                                                </div>

                                                                                <div class="col-xs-12 col-sm-4">
                                                                                    <div class="form-group">
                                                                                        <label>Executing Branch:</label>
                                                                                        @*<input type="text" class="form-control" placeholder="Status Here">*@
                                                                                        @*@Html.TextBoxFor(model => model.Executing_Branch, new { @placeholder = "Executing Branch", @class = "form-control" })*@
                                                                                        @if (ViewBag.SubCatlist != null)
                                                                                        {
                                                                                            @Html.DropDownListFor(m => m.Executing_Branch, ViewBag.SubCatlist as IEnumerable<SelectListItem>, "--Select Branch--", new { @class = "form-control", @id = "Br_Id", })

                                                                                        }
                                                                                        @Html.ValidationMessageFor(model => model.Executing_Branch, "", new { @class = "text-danger validation-msg" })
                                                                                    </div>
                                                                                </div>

                                                                                <div class="col-xs-12 col-sm-4">
                                                                                    <div class="form-group">
                                                                                        <label>Originating Branch:</label>
                                                                                       
                                                                                        @if (ViewBag.SubCatlist != null)
                                                                                        {
                                                                                            @Html.DropDownListFor(m => m.Originating_Branch, ViewBag.SubCatlist as IEnumerable<SelectListItem>, "--Select Branch--", new { @class = "form-control", @id = "Br_Id", })

                                                                                        }
                                                                                        @Html.ValidationMessageFor(model => model.Originating_Branch, "", new { @class = "text-danger validation-msg" })


                                                                                    </div>
                                                                                </div>
                                                                                <div class="col-xs-12 col-sm-4">
                                                                                    <div class="form-group">
                                                                                        <label>Stage Description:</label>
                                                                                        @Html.TextBoxFor(model => model.Description, new { placeholder = "Enter Description", @class = "form-control form-control-custom CompanyName" })
                                                                                        @Html.ValidationMessageFor(model => model.Description, "", new { @class = "text-danger" })
                                                                                    </div>
                                                                                </div>
                                                                                <div class="col-xs-12 col-sm-4">
                                                                                    <div class="form-group">
                                                                                        <label>Item Quantity:</label>
                                                                                        @Html.TextBoxFor(model => model.Quantity, new { placeholder = "Enter Quantity", @class = "form-control form-control-custom CompanyName" })
                                                                                        @Html.ValidationMessageFor(model => model.Quantity, "", new { @class = "text-danger" })
                                                                                    </div>
                                                                                </div>
                                                                                <div class="col-xs-12 col-sm-4">
                                                                                    <div class="form-group">
                                                                                        <label>Sub-Job No:</label>
                                                                                        @Html.TextBoxFor(model => model.Sub_Job, new { placeholder = "Sub Job No", @class = "form-control form-control-custom CompanyName" })
                                                                                        @Html.ValidationMessageFor(model => model.Sub_Job, "", new { @class = "text-danger" })
                                                                                    </div>
                                                                                </div>

                                                                                <div class="col-xs-12 col-sm-4">
                                                                                    <div class="form-group">
                                                                                        <label>Job No:</label>
                                                                                        @*<input type="text" class="form-control" placeholder="TAN Here">*@
                                                                                        @Html.TextBoxFor(model => model.Job, new { @placeholder = "Job", @class = "form-control" })
                                                                                        @Html.ValidationMessageFor(model => model.Job, "", new { @class = "text-danger validation-msg" })
                                                                                    </div>
                                                                                </div>
                                                                                <div class="col-xs-12 col-sm-4">
                                                                                    <div class="form-group">
                                                                                        <label> Planned Date:</label>
                                                                                        @*<input type="text" class="form-control" placeholder="TAN Here">*@
                                                                                        @Html.TextBoxFor(model => model.Planned_Date, "{0:dd MMM yyyy}", htmlAttributes: new { placeholder = "Planned Date", @class = "form-control PlannedDate ", autocomplete = "off" })

                                                                                        @Html.ValidationMessageFor(model => model.Planned_Date, "", new { @class = "text-danger validation-msg" })
                                                                                    </div>
                                                                                </div>

                                                                                <div class="col-xs-12">
                                                                                    <div class="form-group">
                                                                                        <label><i class="fa fa-paperclip" style="color:black;"></i> Related Documents (Please attach files here) : <span style="color:#ff0000;">*</span></label>
                                                                                        <input type="file" class="filepond" name="filepond" id="FileUpload" multiple>
                                                                                        <input hidden="hidden" id="hdfFileUpload" name="FileUpload" class="hidden" />
                                                                                    </div>
                                                                                </div>
                                                                                @if (Model != null)
                                                                                {
                                                                                    if (Model.FileDetails != null && Model.FileDetails.Count > 0)
                                                                                    {
                                                                                        <div class="row">
                                                                                            <div class="col-xs-12">
                                                                                                <div class="form-group">
                                                                                                    <ul class="Attachment">
                                                                                                        @foreach (var item in Model.FileDetails)
                                                                                                        {
                                                                                                            <li>
                                                                                                                <a class="title" href="/Virtual_Call/Download/?p=@(item.IDS + item.Extension)&d=@item.FileName">@item.FileName</a>
                                                                                                                <a href="javascript:void(0);" data-id="@item.IDS" class="deleteItem">X</a>
                                                                                                            </li>
                                                                                                        }
                                                                                                    </ul>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        <p style="color:#FB5F6B;text-align:center;font-weight:bold;">No Files Uploaded</p>
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    <p style="color:#FB5F6B;text-align:center;font-weight:bold;">There are no Attachments !</p>
                                                                                }
                                                                                @*<div class="col-xs-12">
                                                                                    <div class="form-group">
                                                                                        @{
                                                                                            if (Model != null)
                                                                                            {

                                                                                                if (!string.IsNullOrEmpty(Model.Attachment))
                                                                                                {
                                                                                                    <div class="cform-group">
                                                                                                        @{
                                                                                                            string[] words = (Model.Attachment).Split(',');
                                                                                                            for (int i = 0; i < words.Count(); i++)
                                                                                                            {
                                                                                                                <a id="btnAddToCart" class="btn btn-default insert-form-btn" href="@Url.Content("" + words[i])" role="button" download="@Url.Content("~/Content/Uploads/Images/" + words[i])">


                                                                                                                    <i class="fa fa-download"></i>           @words[i]
                                                                                                                </a>
                                                                                                            }
                                                                                                        }
                                                                                                    </div>
                                                                                                            }
                                                                                                            else
                                                                                                            {
                                                                                                                <div class="form-group">

                                                                                                                </div>
                                                                                                                }
                                                                                                            }
                                                                                        }
                                                                                    </div>
                                                                                </div>*@


                                                                                @if (Model.UserRole == "Visible")
                                                                                {
                                                                                    <div class="col-xs-12 col-sm-4">
                                                                                        <div class="form-group">
                                                                                            <label>Add-On Call Status:</label>
                                                                                            @Html.DropDownListFor(model => model.VirtualCallStatus, new List<SelectListItem>
                                                {
                                                    new SelectListItem {Text="---Select---",Value="---Select---" },
                                                    new SelectListItem {Text="Approved",Value="Approved" },
                                                    new SelectListItem {Text="Rejected",Value="Rejected" }
                                                }, new { @class = "form-control" })
                                                                                            @Html.ValidationMessageFor(model => model.VirtualCallStatus, "", new { @class = "text-danger" })
                                                                                        </div>
                                                                                    </div>
                                                                                }

                                                                                <div class="col-xs-12 text-center">
                                                                                    <button type="reset" class="btn btn-default news-btn">Reset</button>
                                                                                    <button type="submit" class="btn btn-default insert-form-btn" id="btnSaveCall"><i class="fa fa-plus-circle"></i>Save</button>
                                                                                </div>

                                                                            </form>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<script type="text/javascript">

    //$(document).ready(function () {

    //    $("#Product_item_Collecton").multiselect({
    //        includeSelectAllOption: true,
    //        enableFiltering: true,
    //        //maxHeight: 350,
    //        buttonWidth: '100%',
    //    });


    //    try {
    //        var list = $("#ProductList").val();

    //        if (typeof list === "undefined") {
    //            list = "";
    //        }

    //        if (list != "") {
    //            var re = list.split(",");
    //            $("#Product_item_Collecton").multiselect('select', re);
    //        }
    //    } catch (err) {

    //    }
    //});
    $(function () {
        $('#ProductLists').multiselect({
            includeSelectAllOption: true
        });
       
    });
   
      
   
    

        @*$(function () {
            $("#Vendor_Name").autocomplete({
                source: function (request, response) {
                    $.ajax({
                       // url: "/Virtual_Call/GetAutoCompleteData/",
                        url: '@Url.Action("GetAutoCompleteData", "Virtual_Call")',
                        data: "{'VendorName':'" + request.term + "'}",
                        datatype: "json",
                        type: "POST",
                        contentType: "application/json;charset-utf-8",
                        success: function (data) {
                            response($.map(data, function (item) {
                                return { label: item.Vendor_Name, value: item.Vendor_Name };
                            }))
                        },
                        minLength: 1
                    });
                }
            });
        });*@
        $(function () {
            $("#Product_item").autocomplete({
                source: function (request, response) {
                    $.ajax({
                       // url: "/Virtual_Call/GetAutoCompleteDataPItem/",
                        url: '@Url.Action("GetAutoCompleteDataPItem", "Virtual_Call")',
                        data: "{'Productname':'" + request.term + "'}",
                        datatype: "json",
                        type: "POST",
                        contentType: "application/json;charset-utf-8",
                        success: function (data) {
                            response($.map(data, function (item) {
                                return { label: item.Product_item, value: item.Product_item };
                            }))
                        },
                        minLength: 1
                    });
                }
            });
        });
        @*$(function () {
            $("#Company_Name").autocomplete({
                source: function (request, response) {
                    $.ajax({
                       
                        url: '@Url.Action("GetAutoCompleteDataCompanyName", "Virtual_Call")',
                        data: "{'companyName':'" + request.term + "'}",
                        datatype: "json",
                        type: "POST",
                        contentType: "application/json;charset-utf-8",
                        success: function (data) {
                            response($.map(data, function (item) {
                                return { label: item.Company_Name, value: item.Company_Name };
                            }))
                        },
                        minLength: 1
                    });
                }
            });
        });*@


</script>

<script type="text/javascript">

$(document).ready(function () {
    $("#Company_Name").autocomplete({
           source: function(request,response) {
               $.ajax({
                   //url: "/TrainingSchedule/GetRecord",
                   url: '@Url.Action("GetRecord", "Virtual_Call")',
                   type: "POST",
                   dataType: "json",
                   data: { Prefix: request.term },
                   success: function (data) {
                       response($.map(data, function (item) {
                           return { label: item.Company_Name, value: item.Company_Name };
                       }))

                   }
               })
           },
           messages: {
               noResults: "", results: ""
           }
       });
})
</script>
<script type="text/javascript">

$(document).ready(function () {
    $("#Vendor_Name").autocomplete({
           source: function(request,response) {
               $.ajax({
                   //url: "/TrainingSchedule/GetRecord",

                   url: '@Url.Action("GetRecord", "Virtual_Call")',
                   type: "POST",
                   dataType: "json",
                   data: { Prefix: request.term },
                   success: function (data) {
                       response($.map(data, function (item) {
                           return { label: item.Company_Name, value: item.Company_Name };
                       }))

                   }
               })
           },
           messages: {
               noResults: "", results: ""
           }
       });
})
</script>




<script type="text/javascript">
    //$(document).ready(function () {
    //    $('.datepickerC').datepicker({
    //        dateFormat: "dd/M/yy",
    //        changeMonth: true,
    //        changeYear: true,
    //        yearRange: "-60:+0"
    //    }).on('change', function (ev) {
    //        $(this).valid();
    //    });
    $(function () {
        $(".datepickerC").datepicker({
            dateFormat: 'dd/mm/yy',//check change
            changeMonth: true,
            changeYear: true,
            yearRange: "-100:+50"
        });
    });
        $("#btnSaveCall").on('click', function ()
        {
         //   debugger;
            var ProductLists = $("#ProductLists option:selected").val();
            var VirtualCallStatus = $("#VirtualCallStatus").val();
           // alert(VirtualCallStatus);

            if ($("#Company_Name").val() == "" || $("#Company_Name").val() == null) {
                alert("Please enter Company Name !!!");
                $("#Company_Name").focus()
                return false;
            }
            if ($("#PO_Number").val() == "" || $("#PO_Number").val() == null) {
                alert("Please enter PO Number !!!");
                $("#PO_Number").focus()
                return false;
            }
            if ($("#Source").val() == "" || $("#Source").val() == null) {
                alert("Please enter Buyers Name !!!");
                $("#Source").focus()
                return false;
            }
            if ($("#ContactName").val() == "" || $("#ContactName").val() == null) {
                alert("Please enter Contact Name !!!");
                $("#ContactName").focus()
                return false;
            }
            if ($("#Call_received_date").val() == "" || $("#Call_received_date").val() == null) {
                alert("Please enter Call Received Date !!!");
                $("#Call_received_date").focus()
                return false;
            }
            if ($("#Call_Request_Date").val() == "" || $("#Call_Request_Date").val() == null) {
                alert("Please enter Call Requested Date !!!");
                $("#Call_Request_Date").focus()
                return false;
            }
            if ($("#Category Option:selected").val() == "" || $("#Category Option:selected").val() == null) {
                alert("Please select Category !");
                $("#Category").focus()
                return false;
            }
            if ($("#Vendor_Name").val() == "" || $("#Vendor_Name").val() == null) {
                alert("Please enter Vendor Name !!!");
                $("#Vendor_Name").focus()
                return false;
            }  
            //ProductLists
            //if ($("#ProductList").val() == "" || $("#ProductList").val() == null) {
            //    alert("Please select the product !!!");
            //    $("#ProductList").focus()
            //    return false;
            //}
            if (ProductLists == "" || ProductLists == null) {
                alert("Please select any Product !!!");
                $("#ProductList").focus()
                return false;
            }
            if ($("#Project_Name").val() == "" || $("#Project_Name").val() == null) {
                alert("Please enter Project Name !!!");
                $("#Project_Name").focus()
                return false;
            }
            if ($("#Job_Location").val() == "" || $("#Job_Location").val() == null) {
                alert("Please enter Job Location !!!");
                $("#Job_Location").focus()
                return false;
            }
            /*if ($("#Client_Email").val() == "" || $("#Client_Email").val() == null) {
                alert("Please enter Client Email !!!");
                $("#Client_Email").focus()
                return false;
            }
            if ($("#Vendor_Email").val() == "" || $("#Vendor_Email").val() == null) {
                alert("Please enter Vendor Email !!!");
                $("#Vendor_Email").focus()
                return false;
            }*/
            //if ($("#Tuv_Branch").val() == "" || $("#Tuv_Branch").val() == null) {
            //    alert("Please enter Home Branch !!!");
            //    $("#Tuv_Branch").focus()
            //    return false;
            //}
            if ($("#Description").val() == "" || $("#Description").val() == null) {
                alert("Please enter Description!!!");
                $("#Description").focus()
                return false;
            }
            if ($("#Quantity").val() == "" || $("#Quantity").val() == null) {
                alert("Please enter Quantity!!!");
                $("#Quantity").focus()
                return false;
            }

            if(VirtualCallStatus != 'undefined')
            {

                if (VirtualCallStatus == 'Approved' && ($("#Sub_Job").val() == "" || $("#Sub_Job").val() == null)) {
                    alert("Please enter Sub Job No!!!");
                    $("#Sub_Job").focus()
                    return false;
                }

                if (VirtualCallStatus == 'Approved' && ($("#Job").val() == "" || $("#Job").val() == null)) {
                    alert("Please enter Job No!!!");
                    $("#Sub_Job").focus()
                    return false;
                }
            }
            
       
     });
</script>

<script src="~/AllJsAndCss/js/filepond.js"></script>

<!-- Turn all file input elements into ponds -->
<script>
    FilePond.parse(document.body);
</script>

<script>
    var SummaryExtension = false;
    var fileExtension = ["pdf", "PDF", "xls", "xlsx", "doc", "DOC", "docx", "DOCX", "png", "PNG", "jpg", "JPG", "JPEG", "gif"];
    $("#FileUpload").change(function (e) {
        debugger;
        var files = $("#FileUpload input[type='file']").get(0).files;
        for (var index = 0; index < files.length; index++)
        {
            var singleExtension = e.target.files[index].name.split('.').pop();
            var Condition = fileExtension.includes(singleExtension);
            if (Condition == true)
            {
                SummaryExtension = true;
            }
            else
            {
                alert("Only formats are allowed : " + fileExtension.join(','));
                SummaryExtension = false;
                return;
            }
        }
        if (SummaryExtension == true)
        {
            var fileData = new FormData();
            for (var i = 0; i < files.length; i++)
            {
                fileData.append("FileUpload input[type='file']", files[i]);
            }
            //Creating an XMLHttpRequest and sending
            var xhr = new XMLHttpRequest();
            var link = '@Url.Action("TemporaryFilePathDocumentAttachment", "Virtual_Call")';
            xhr.open('POST', link, 'true');
            xhr.send(fileData);
            xhr.onreadystatechange = function ()
            {
                if (xhr.readyState == 4 && xhr.status == 200)
                {
                    var data = xhr.responseText;
                    data = data.replace(/"/g, "");
                    $("#Attachment").val(data);
                }
            }
            //})
        }



    })
</script>    




<script>
    $(function () {
        $(".FromD").datepicker({
            dateFormat: 'yy-mm-dd',//check change
            changeMonth: true,
            changeYear: true,
            yearRange: "-100:+50" 
        });
    });
</script>
<script>
    $(function () {
        $(".ToD").datepicker({
            dateFormat: 'yy-mm-dd',//check change
            changeMonth: true,
            changeYear: true,
            yearRange: "-100:+50"
        });
    });
</script>


<script src="~/AllJsAndCss/js/bootstrap-multiselect.js"></script>
<script>
    $('.form-multiselect-city').multiselect({
        enableFiltering: true,
        includeSelectAllOption: true,
        enableCaseInsensitiveFiltering: true
    });
</script>
<script>
    $(document).ready(function () {
        $('.deleteItem').click(function (e) {
            debugger;
            e.preventDefault();
            var $ctrl = $(this);
            var EnquiryID = $("#EQ_ID").val();
            if (confirm('Do you really want to Delete this file?')) {
                $.ajax({
                    url: '@Url.Action("DeleteFile")',
                    type: 'POST',
                    data: { id: $(this).data('id'), EnquiryID: $("#EQ_ID").val() }
                }).done(function (data) {
                    if (data.Result == "OK") {
                        $ctrl.closest('li').remove();
                    }
                    else if (data.Result.Message) {
                        alert(data.Result.Message);
                    }
                }).fail(function () {
                    alert("Something went Wrong, Please try again!");
                })

            }
        });
    });

</script>







