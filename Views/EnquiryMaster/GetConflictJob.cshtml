@model TuvVision.Models.EnquiryMaster
@using NonFactors.Mvc.Grid;
@using System.Web.Mvc;

@{
    ViewBag.Title = "GetConflictJob";
    Layout = "~/Views/Shared/_TuvVision.cshtml";

    int j = 0;
    int k = 0;
    int i = 0;
}

<link href="~/AllJsAndCss/css/MVCGridN.css" rel="stylesheet" />

@*Ashwini Scripts here for datatable starts here*@
<script type="text/javascript" language="javascript" src="~/AllJsAndCss/datatable/js/jquery.dataTables.js"></script>

<script src="~/AllJsAndCss/datatable/js/jquery.dataTables.js"></script>

<script src="~/AllJsAndCss/js/datatable-custom.js"></script>


@using (Html.BeginForm())
{
   <!--Start of header-->
    <!--Start of main content 3-->
    <div class="main-content3 xs-max-height">

        <!--Start of header-->
        <div class="container-fluid">
            <div class="row assignfixedwidth rp-15">

                <div class="col-xs-12">
                    <h3 class="dynamic-page-title dynamic-page-title-2  text-left">Conflict Job</h3>
                    @*<a href="@Url.Action("Enquiry","EnquiryMaster")" class="btn btn-info dynamic-function-btn dynamic-function-btn-2 mr-1"><i class="fa fa-plus-circle"></i> Add New Enquiry</a>
                        <button type="button" value="ExportToExcel" class="btn btn-info dynamic-function-btn dynamic-function-btn-2 " style='margin-right:16px' onclick="location.href='@Url.Action("ExportIndex","EnquiryMaster")'">
                            Export To Excel
                        </button>*@
                </div><!-- /.col -->

                <div class="col-xs-12">
                    <hr class="custom-hr">
                </div><!-- /.col -->
                <!--Table was here-->

            </div><!-- /.row -->


            <div class="white-bg section-box-shadow">

                <div class="row">
                    <div class="col-xs-12 col-sm-offset-1 col-sm-10">
                        <div class="form-box">

                            @if (ViewBag.lstConflictJobs != null)
                            {
                                if (ViewBag.lstConflictJobs.Count != 0)
                                {
                                    <div id="DomesticCurrency" style='width:100% ;align:center;'>
                                        <div class="form-page-title"><label>Conflict Jobs</label></div>

                                        <table id="DTestTable" cellspacing="0" cellpadding="3" border="1" style="width: 100%">
                                            <tr>
                                                <td width="200px">
                                                    Job Number
                                                </td>
                                                <td width="200px">
                                                    Enquiry Number
                                                </td>
                                                <td width="200px">
                                                    Company Name
                                                </td>
                                                <td width="200px">
                                                    Service Type
                                                </td>
                                                <td width="200px">
                                                    Branch
                                                </td>


                                            </tr>


                                            @foreach (var item in ViewBag.lstConflictJobs as IEnumerable<TuvVision.Models.EnquiryMaster>)
                                            {
                                                i = i + 1;

                                                <tr class="trDomestic">


                                                    <td>
                                                        @*@Html.TextBoxFor(model => model.lstConflictJobs[j].JobNumber, new { @placeholder = "Order Rate", @class = "form-control  COrderRate", @onkeypress = "return isNumberKey(event);", @Value = item.JobNumber, @id = "IddOrderType" + i, @readonly = "readonly" })*@
                                                        <a href="@Url.Action("JobCreation", "JobMaster", new {  @PK_JOB_ID = item.PK_Job_Id })" > @item.JobNumber &nbsp;</a>
                                                        @Html.ValidationMessageFor(model => model.JobNumber, "", new { @class = "text-danger validation-msg" })
                                                    </td>
                                                    <td>
                                                        @Html.TextBoxFor(model => model.lstConflictJobs[j].EnquiryNumber, new { @placeholder = "Order Rate", @class = "form-control  COrderRate", @onkeypress = "return isNumberKey(event);", @Value = item.EnquiryNumber, @id = "IddOrderType" + i, @readonly = "readonly" })
                                                        @Html.ValidationMessageFor(model => model.JobNumber, "", new { @class = "text-danger validation-msg" })
                                                    </td>
                                                    <td>
                                                        @Html.TextBoxFor(model => model.lstConflictJobs[j].CompanyName, new { @placeholder = "Order Rate", @class = "form-control  COrderRate", @onkeypress = "return isNumberKey(event);", @Value = item.CompanyName, @id = "IddOrderType" + i, @readonly = "readonly" })
                                                        @Html.ValidationMessageFor(model => model.JobNumber, "", new { @class = "text-danger validation-msg" })
                                                    </td>
                                                    <td>
                                                        @Html.TextBoxFor(model => model.lstConflictJobs[j].SubServiceType, new { @placeholder = "Order Rate", @class = "form-control  COrderRate", @onkeypress = "return isNumberKey(event);", @Value = item.SubServiceType, @id = "IddOrderType" + i, @readonly = "readonly" })
                                                        @Html.ValidationMessageFor(model => model.JobNumber, "", new { @class = "text-danger validation-msg" })
                                                    </td>
                                                    <td>
                                                        @Html.TextBoxFor(model => model.lstConflictJobs[j].Branch, new { @placeholder = "Order Rate", @class = "form-control  COrderRate", @onkeypress = "return isNumberKey(event);", @Value = item.Branch, @id = "IddOrderType" + i, @readonly = "readonly" })
                                                        @Html.ValidationMessageFor(model => model.JobNumber, "", new { @class = "text-danger validation-msg" })
                                                    </td>
                                                </tr>
                                                j++;
                                            }


                                        </table>
                                    </div>
                                }
                            }


                        </div>
                    </div>
                </div>
            </div>




            @*<div class="col-xs-12">



                    <table class="display dataTable no-footer" style="overflow-y:auto" id="gridMapping">
                        <tr>
                            <td>
                                @(Html
                    .Grid(Model.lstConflictJobs)
                    .Build(columns =>
                    {

                        columns.Add(c => c.JobNumber).Titled("Job Number");
                        columns.Add(c => c.EnquiryNumber).Titled("Enquiry Number");
                        columns.Add(c => c.CompanyName).Titled("Company Name");
                        columns.Add(c => c.SubServiceType).Titled("Service Type");
                        columns.Add(c => c.Branch).Titled("Branch");




                    })
                    .Pageable(pager =>
                    {
                        pager.ShowPageSizes = true;
                        pager.PagesToDisplay = 3;
                        pager.CurrentPage = 1;
                        pager.RowsPerPage = 2;
                    })
                    .UsingFilterMode(GridFilterMode.Row)
                    .Empty("No data found")
                    .Filterable()
                    .Sortable()

                                )


                            </td>
                        </tr>
                    </table>


                </div>*@



            <!-- /.data table col -->
            @*<div class="col-xs-12">

                    @if (ViewBag.lstIOrderType != null)
                    {
                        if (ViewBag.lstIOrderType.Count != 0)
                        {
                            <div id="InternationalCurrency" style='width:100% ;align:center;'>

                                <div class="form-page-title"><label></label></div>

                                <table id="example" cellspacing="0" cellpadding="3" border="1" style="width: 100%">
                                    <tr>
                                        <td width="200px">
                                            Reason
                                        </td>
                                    </tr>

                                    @foreach (var item in ViewBag.lstIOrderType as IEnumerable<TuvVision.Models.EnquiryMaster>)
                                    {
                                        int l = 0;
                                        l = l + 1;

                                        <tr class="trInternational">
                                            <td>

                                                @Html.TextBoxFor(model => model.lstConflictJobsApproval[k].Reason, new { @placeholder = "Reason", @class = "form-control CIDistance", autocomplete = "off", @id = "ddlIDistance" + l, @Value = item.Reason })
                                                @Html.ValidationMessageFor(model => model.Reason, "", new { @class = "text-danger validation-msg CIDistance" })

                                            </td>
                                        </tr>
                                    }

                                </table>
                            </div>
                        }
                    }

                </div>*@


            <form method="post" enctype="multipart/form-data">
                @*<div class="container-fluid">
                        <div class="row assignfixedwidth rp-15">


                            @Html.HiddenFor(m => m.EQ_ID)

                            <div class="col-xs-12">
                                <table id="example1" class="display custom-table" cellspacing="0" width="100%">

                                    <thead>
                                        <tr>
                                            <th>Metigation Plan</th>
                                            <th>PCH Approval</th>
                                            <th>CH Approval</th>
                                            <th>QA Approval</th>
                                        </tr>
                                    </thead>

                                    @if (ViewBag.lstIOrderType.Count != 0)
                                                {
                                                <tbody>
                                                    @foreach (var item in ViewBag.lstIOrderType as IEnumerable<TuvVision.Models.EnquiryMaster>)
                                                        {
                                                            int l = 0;
                                                            l = l + 1;
                                                    <tr>
                                                        <td>
                                                            @Html.TextBoxFor(model => model.lstConflictJobsApproval[k].Reason, new { @placeholder = "Reason", @class = "form-control CIDistance", autocomplete = "off", @id = "ddlIDistance" + l, @Value = item.Reason })
                                                        </td>
                                                        <td>
                                                            @item.PCHApproval
                                                        </td>
                                                        <td>
                                                            @item.CHApproval
                                                        </td>
                                                        <td>
                                                            @item.QAApproval
                                                        </td>
                                                    </tr>
                                                        }
                                                </tbody>
                                                }


                                </table>
                            </div>
                        </div>
                    </div>*@

                <div class="container-fluid">
                    <div class="row assignfixedwidth rp-15">


                        @Html.HiddenFor(m => m.EQ_ID)

                        <div class="col-xs-12">
                            <table id="example1" class="display custom-table" cellspacing="0" width="100%">

                                <thead>
                                    <tr>
                                        <th>Metigation Plan</th>
                                        <th>PCH Approval Status</th>
                                        @if (Model.PCHID == Model.SessionId)
                                        {
                                            <th>PCH Approval</th>
                                        }

                                        <th>CH Approval Status</th>
                                        @if (Model.CHID == Model.SessionId)
                                        {
                                            <th>CH Approval</th>
                                        }

                                        @*<th>QA Approval Status</th>
                                        @if (Model.BranchQAID == Model.SessionId)
                                        {
                                            <th>QA Approval</th>
                                        }*@

                                    </tr>
                                </thead>

                                @*@if (ViewBag.lstIOrderType.Count != 0)
                                    {*@
                                <tbody>

                                    <tr>
                                        <td>
                                            @Html.TextAreaFor(model => model.Reason, new { @placeholder = "Reason", @class = "form-control CIDistance", autocomplete = "off" })
                                        </td>
                                        <td>
                                            @Html.DisplayFor(model => model.PCHApproval)
                                        </td>
                                        @if (Model.PCHID == Model.SessionId)
                                        {
                                            <td class="less-width">
                                                <a href="@Url.Action("ChangeApprovalStatus", "EnquiryMaster", new { @Type="PCH",Status="1", @EQ_ID = Model.EQ_ID })" title="Approved"><span class="fa fa-times"></span>&nbsp;</a>
                                                <a href="@Url.Action("ChangeApprovalStatus", "EnquiryMaster", new {  @Type="PCH",Status="0", @EQ_ID = Model.EQ_ID })" title="Reject"><span class="fa fa-check"></span>&nbsp;</a>
                                            </td>
                                        }
                                        <td>
                                            @Html.DisplayFor(model => model.CHApproval)
                                        </td>
                                        @if (Model.CHID == Model.SessionId)
                                        {
                                            <td class="less-width">
                                                <a href="@Url.Action("ChangeApprovalStatus", "EnquiryMaster", new { @Type="CH",Status="1", @EQ_ID = Model.EQ_ID })" title="Approved"><span class="fa fa-times"></span>&nbsp;</a>
                                                <a href="@Url.Action("ChangeApprovalStatus", "EnquiryMaster", new { @Type="CH",Status="0", @EQ_ID = Model.EQ_ID })" title="Reject"><span class="fa fa-check"></span>&nbsp;</a>
                                            </td>
                                        }
                                        @*<td>
                                            @Html.DisplayFor(model => model.QAApproval)
                                        </td>
                                        @if (Model.BranchQAID == Model.SessionId)
                                        {
                                            <td class="less-width">
                                                <a href="@Url.Action("ChangeApprovalStatus", "EnquiryMaster", new { @Type="QA",Status="1", @EQ_ID = Model.EQ_ID })" title="Approved"><span class="fa fa-times"></span>&nbsp;</a>
                                                <a href="@Url.Action("ChangeApprovalStatus", "EnquiryMaster", new { @Type="QA",Status="0", @EQ_ID = Model.EQ_ID })" title="Reject"><span class="fa fa-check"></span>&nbsp;</a>
                                            </td>
                                        }*@
                                    </tr>

                                </tbody>
                                @*}*@


                            </table>
                        </div>
                    </div>
                </div>





                <div class="col-xs-12 text-center">
                    <button type="submit" class="btn btn-default insert-form-btn"><i class="fa fa-plus-circle"></i>Save </button>
                </div>
            </form>



            @*</div>
                        </div>
                    </div>
                </div>*@







        </div><!-- /.container-fluid -->
        <!--End of header-->

    </div>
                    <!--End of main content 3-->
}

