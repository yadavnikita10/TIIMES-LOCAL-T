@model TuvVision.Models.DocumentRevieweModel

@{
    ViewBag.Title = "DocumentReviewed";
    Layout = "~/Views/Shared/_TuvVision.cshtml";
}

<script type="text/javascript" language="javascript" src="~/AllJsAndCss/datatable/js/jquery.dataTables.js"></script>
<script src="~/AllJsAndCss/datatable/js/jquery.dataTables.js"></script>
<script src="~/AllJsAndCss/js/datatable-custom.js"></script>
@*<div class="white-bg section-box-shadow">
    <h3 class="dynamic-page-title dynamic-page-title-2  " style="margin-left:10px;"> Document Reviewed </h3>
    <div class="row">*@

        <div class="main-content3 xs-max-height grey-bg-f3">
            <div class="grey-bg-f3">
                <!--Start of header-->
                <div class="container-fluid">
                    <div class="col-xs-12 col-sm-offset-1 col-sm-10">

                        <div class="col-xs-12 form-col">
                            <div class="row">
                                <br />
                                <h5 class="dynamic-page-title dynamic-page-title-2 " style="padding-left: 11px;">Inspection Visit Report Number : @Session["VisitReportNo"]</h5>
                                @*<a href="@Url.Action("CallsListByInspector","CallsMaster")" class="btn btn-info dynamic-function-btn dynamic-function-btn-2"><i class="fa fa-long-arrow-left"></i> Go Back</a>*@


                                <div class="col-xs-12">


                                    @if (Model.PK_CALL_ID != 0)
            {
                                        <button class="btn btn-default news-btn" type="button" onclick="location.href='@Url.Action("VisitReportForm", "VisitReport",new { @PK_Call_ID = Model.PK_CALL_ID,@PK_RM_ID = Model.abcid} )'">General</button>
                                        <button class="btn btn-default news-btn" type="button" onclick="location.href='@Url.Action("ItemDescription", "VisitReport",new { @PK_Call_ID = Model.PK_CALL_ID,@PK_RM_ID = Model.abcid} )'"> Item Description</button>

                                        <button class="btn btn-default news-btn" type="button" onclick="location.href='@Url.Action("ReferenceDocuments", "VisitReport",new { @PK_Call_ID = Model.PK_CALL_ID,@PK_RM_ID = Model.abcid} )'">Reference Documents </button>
                                        <button class="btn btn-default news-btn" type="button" onclick="location.href='@Url.Action("InspectionActivites", "VisitReport",new { @PK_Call_ID = Model.PK_CALL_ID,@PK_RM_ID = Model.abcid} )'"> Stages Witnessed</button>
                                        <button class="btn btn-default insert-form-btn" type="button" onclick="location.href='@Url.Action("DocumentReviewed", "VisitReport",new { @PK_Call_ID = Model.PK_CALL_ID,@PK_RM_ID = Model.abcid} )'">Document Reviewed</button>
                                        <button class="btn btn-default news-btn" type="button" onclick="location.href='@Url.Action("EquipmentDetails", "VisitReport",new { @PK_Call_ID = Model.PK_CALL_ID,@PK_RM_ID = Model.abcid} )'">Details Of Measuring Instrument</button>
                                        <button class="btn btn-default news-btn" type="button" onclick="location.href='@Url.Action("Conclusion", "VisitReport",new { @PK_Call_ID = Model.PK_CALL_ID,@PK_RM_ID = Model.abcid} )'">Conclusion</button>

                                        <button class="btn btn-default news-btn" type="button" onclick="location.href='@Url.Action("ReportImage", "VisitReport",new { @PK_Call_ID = Model.PK_CALL_ID,@PK_RM_ID = Model.abcid} )'">Image</button>
                                        <button class="btn btn-default news-btn" type="button" onclick="location.href='@Url.Action("IvrReports", "VisitReport",new { @PK_CALL_ID = Model.PK_CALL_ID,@PK_RM_ID = Model.abcid} )'">Report</button>
                                        <button class="btn btn-default news-btn" type="button" onclick="location.href='@Url.Action("AllConcern", "VisitReport",new { @PK_CALL_ID = Model.PK_CALL_ID , @PK_RM_ID = Model.abcid } )'">List of Issues</button>

                                        @*<button class="btn btn-info dynamic-function-btn" type="button" onclick="location.href='@Url.Action("IvrReports", "VisitReport",new { @PK_CALL_ID = Model.PK_CALL_ID} )'">Report</button>*@
            }




                                </div>

                            </div>

                            <div class="row">


                                <div class="col-xs-12">
                                    <div class="white-bg section-box-shadow">
                                        <h3 class="form-page-title">Document Review</h3>
                                        <div class="row">
                                            <div class="col-xs-12 col-sm-offset-1 col-sm-10">

                                                <div class="form-box">
                                                    <form method="post" enctype="multipart/form-data">
                                                        @Html.HiddenFor(m => m.PK_CALL_ID)
                                                        @Html.HiddenFor(m => m.PK_DR_ID)

                                                        <div class="row">
                                                            <div class="col-xs-12 col-sm-12">
                                                                <div class="form-group">
                                                                    <label>Document Reviewed:</label>
                                                                    <br />
                                                                    <span style="color:#E12F24;">
                                                                        <strong> &nbsp;Note : </strong>
                                                                    </span>
                                                                    Statement shall give clear idea to customer of performed activity <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(i.e. QAP Stage No.  - Inspection activity carried out - findings).
                                                                    <br />
                                                                    @Html.TextAreaFor(model => model.Description, 10, 40, new { @placeholder = "Enter in Detailed Description", @class = "form-control" })
                                                                    @Html.ValidationMessageFor(model => model.Description, "", new { @class = "text-danger validation-msg" })
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-xs-12 text-center" id="IVRPointerEvents">
                                                            <button type="submit" class="btn btn-default insert-form-btn">Save </button>
                                                        </div>
                                                        @*added by satish yadav for showing autosuggestion message*@
                                                        <div id="suggestions-container" class="suggestions"></div>
                                                        @*end here autosuggestion message*@
                                                    </form>
                                                </div>
                                            </div>
                                        </div>



                                        <div class="row">
                                            <div class="col-xs-12">
                                                <div class="col-xs-12">
                                                    <table id="example" class="display custom-table" cellspacing="0" width="100%">

                                                        <thead>
                                                            <tr>
                                                                <th class="remove-search" width="5%">Sr No</th>
                                                                <th class="remove-search" width="90%">Document Reviewed</th>

                                                                <th class="remove-search" width="5%">Action</th>
                                                            </tr>
                                                        </thead>

                                                        <tbody>

                                                            @{
                                                            int i = 0;
                                                            }
                                                            @foreach (var item in ViewData["CostSheet"] as IEnumerable<TuvVision.Models.DocumentRevieweModel>)
                                                        {
                                                            i = i + 1;
                                                                <tr>

                                                                    <td width="5%">@i</td>
                                                                    <td style='white-space: pre-line;' width="90%">@item.Description</td>

                                                                    <td class="less-width" width="5%">
                                                                        <a href="@Url.Action("DocumentReviewed", "VisitReport", new {@PK_DR_ID = item.PK_DR_ID })" title="Edit"><span class="fa fa-pencil"></span>&nbsp;</a>
                                                                        <a href="@Url.Action("DeleteDocumentReviewedData", "VisitReport", new {@PK_DR_ID = item.PK_DR_ID,@PK_CALL_ID = item.PK_CALL_ID })" onclick="return confirm('Are you sure you want to Delete this Record?')" title="Delete"><span class="fa fa-trash-o"></span>&nbsp;</a>
                                                                        @{
                                                                        if ((Convert.ToString(TempData["InsertCompany"])) != "" && Convert.ToString(TempData["InsertCompany"]) != null)
                                                                        {
                                                                            TempData["InsertCompany"] = null;
                                                                                @*<script type="text/javascript" language="javascript">
                                                                alert("Item Description Added Successfully...");
                                                            </script>*@
                                                                        }
                                                                        if ((Convert.ToString(TempData["UpdateCompany"])) != "" && Convert.ToString(TempData["UpdateCompany"]) != null)
                                                                        {
                                                                            TempData["UpdateCompany"] = null;
                                                                                @*<script type="text/javascript" language="javascript">
                                                                alert("Cost Sheet Approved Successfully...");
                                                            </script>*@
                                                                        }
                                                                        }
                                                                    </td>

                                                                </tr>
                                                                        }

                                                        </tbody>

                                                    </table>
                                                </div>

                                            </div>
                                            <!--Contact Details By Manoj -->


                                        </div><!-- /.box-shadow -->

                                    </div>
                                </div>

                            </div>



                        </div>
                    </div>
                </div>

            </div>
            </div>
                                                @*<div class="main-content3 xs-max-height">

                                                    
                                                    <div class="container-fluid">
                                                        

                                                    


                                                    </div>


                                                </div>
                                                }*@


<script>
    @*added by satish yadav for Autosuggestion*@
        $(document).ready(function () {
            const $textarea = $("#Description");
            const $suggestionsContainer = $("#suggestions-container");

            $textarea.on("input", function () {
                debugger;
                const query = $(this).val().toLowerCase();
                const id = $("#PK_CALL_ID").val();
                if (query) {
                    $.ajax({
                        url: '@Url.Action("GetSuggestions", "VisitReport")',
                        data: { Searchres: query, PK_CALL_ID:id },
                        success: function (response) {
                            if (response.success) {
                                displaySuggestions(response.data);
                            } else {
                                console.error(response.error);
                            }
                        }
                    });
                } else {
                    $suggestionsContainer.empty();
                }
            });

            $suggestionsContainer.on("click", ".suggestion-item", function () {
                const text = $(this).text();
                $textarea.val(text);
                $suggestionsContainer.empty();
            });

            $(document).on("click", function (event) {
                if (!$(event.target).closest("#Description, #suggestions-container").length) {
                    $suggestionsContainer.empty();
                }
            });

            function displaySuggestions(items) {
                $suggestionsContainer.empty();
                items.forEach(item => {
                    const $suggestionItem = $("<p>").addClass("suggestion-item").text(item.Name);
                    $suggestionsContainer.append($suggestionItem);
                });
            }
        });
</script>
<style>
    .suggestions {
        border: 1px solid #ccc;
        max-height: 150px;
        overflow-y: auto;
        position: absolute;
        z-index: 1000;
        background-color: white;
    }

    .suggestion-item {
        padding: 10px;
        cursor: pointer;
        margin: 0;
    }

        .suggestion-item:hover {
            background-color: #f0f0f0;
        }
</style>

@*end here autosuggestion*@


<script>
    var isConfirmationIVR = @Session["IsConfirmationIVR"] ?? 0;
    // JavaScript to disable pointer events if isConfirmationIVR is 1

    if (isConfirmationIVR == 1) {
        document.getElementById("IVRPointerEvents").style.pointerEvents = "none";
    }
</script>


