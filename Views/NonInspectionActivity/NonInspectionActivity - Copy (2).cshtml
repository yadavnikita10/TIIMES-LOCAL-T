@model TuvVision.Models.NonInspectionActivity
@using NonFactors.Mvc.Grid;
@using System.Web.Mvc;
@{
    //ViewBag.Title = "NonInspectionActivity";
    Layout = "~/Views/Shared/_TuvVision.cshtml";
    int l = 0;
}

<link href="~/AllJsAndCss/css/MVCGridN.css" rel="stylesheet" />

<style>
    .addCSS {
        pointer-events: none;
    }
</style>

@*<style>
    #customers {
        font-family: Arial, Helvetica, sans-serif;
        border-collapse: collapse;
        width: 100%;
    }

        #customers td, #customers th {
            border: 1px solid #ddd;
            padding: 8px;
        }

        #customers tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        #customers tr:hover {
            background-color: #ddd;
        }

        #customers th {
            padding-top: 12px;
            padding-bottom: 12px;
            text-align: left;
            /*background-color: #04AA6D;*/
            background-color: #001ED2;
            color: white;
        }

         .grdSAPWidth {
            width:800px;
        }
</style>*@


@helper CustomRenderingOfColumnExpense(TuvVision.Models.NonInspectionActivity callmodel)
{
    <button id="btnAddExpenses" class="btn btn-info btn-xs" type="button" onclick="location.href='@Url.Action("CreateExpenseItem", "ExpenseItem",new { FKId = callmodel.Id,Type="NIA",SubJobNo="",PK_Call_Id=callmodel.Id} )'"><i class="fa fa-pencil"></i></button>

    @*<a href="@Url.Action("NonInspectionActivity", "NonInspectionActivity", new { id = callmodel.Id, AddExpense1 = "AddExpense" })" class="btn btn-info btn-xs" title="Edit"  ><i class="fa fa-pencil"></i></a>*@


    @*<button type="button" class="btn btn-default insert-form-btn" id="ddlInspectionLocation" style="width:125px;"> Expense</button>*@
}
@helper CustomRenderingOfColumn(TuvVision.Models.NonInspectionActivity callmodel)
{
if (callmodel.ActivityType == "Privilege Leave" || callmodel.ActivityType == "Sick Leave" || callmodel.ActivityType == "Casual Leave")
{

}
else
{
        @*<a href="@Url.Action("UpdateNonInspectionActivity", "NonInspectionActivity", new { id = callmodel.Id })" class="btn btn-info btn-xs" title="Edit"><i class="fa fa-pencil"></i></a>*@
        <a href="@Url.Action("NonInspectionActivity", "NonInspectionActivity", new { id = callmodel.Id })" class="btn btn-info btn-xs" title="Edit"><i class="fa fa-pencil"></i></a>
       
        <a href="@Url.Action("Delete", "NonInspectionActivity", new { id = callmodel.Id })" class="delete" onclick="return confirm('Are you sure you wish to Delete selected Record?');" title="Delete"><i class="fa fa-trash"></i></a>


}
}
@helper CustomRenderingOfColumnAttachment(TuvVision.Models.NonInspectionActivity callmodel)
{
if (callmodel.Attachment == null || callmodel.Attachment == "")
{

}
else
{
    string[] words = (callmodel.Attachment).Split(',');
    for (int j = 1; j < words.Count(); j++)
    {
            <a target="_blank" href="@Url.Content("~/NonInspectionActivityDocument/" + words[j-1])">
                
                <span>@words[j - 1].ToString()</span>
            </a>
            
    }


}
}


@*<button type="button" class="btn btn-default insert-form-btn" id="ddlInspectionLocation" style="width:125px;"> Expense</button>*@







@using (Html.BeginForm("Create", "NonInspectionActivity", FormMethod.Post, new { enctype = "multipart/form-data", @id = "form1" }))
{
    <div class="main-content3 xs-max-height grey-bg-f3">
        <div class="grey-bg-f3">
            <!--Start of header-->
            <div class="container-fluid">
                <div class="row assignfixedwidth rp-5">
                    @*<a href="@Url.Action("ListNonInspectionActivity","NonInspectionActivity")" class="btn btn-default news-btn" style="float:right;"><i class="fa fa-long-arrow-left"></i> Go Back</a>*@

                    <br />
                    <div class="col-xs-12 form-col">
                        <div class="row">


                            <div class="col-xs-12">
                                <div class="white-bg section-box-shadow">
                                    <h3 class="form-page-title"> Non Inspection Activities</h3>
                                    <div class="row">
                                        <div class="col-xs-12 col-sm-offset-1 col-sm-10">
                                            <div class="form-box">
                                                <form>
                                                    <div class="row">
                                                        <div class="col-xs-12 col-sm-4">
                                                            @Html.HiddenFor(model => model.Id)
                                                            @Html.HiddenFor(model => model.AddExpense)
                                                        </div>
                                                    </div>


                                                    <div class="row">
                                                        @if (Convert.ToString(TempData["Error"]) != string.Empty)
                                                        {
                                                            <div class="col-xs-12">
                                                                @if (Convert.ToString(TempData["Error"]) != null && Convert.ToString(TempData["Error"]) != "")
                                                                {
                                                                    <h5 style="color:red;font-weight:bold;">@Convert.ToString(TempData["Error"]).Replace("<br />", "\"<br/>\"")</h5>

                                                                }
                                                            </div>
                                                            TempData["Error"] = "";
                                                        }

                                                        @if (Convert.ToString(TempData["Success"]) != "")
                                                        {

                                                            <div class="col-xs-12">

                                                                @{
                                                                    if (Convert.ToString(TempData["Success"]) != null && Convert.ToString(TempData["Success"]) != "")
                                                                    {
                                                                        <h5 style="color:green;font-weight:bold;">@Convert.ToString(TempData["Success"])</h5>
                                                                    }
                                                                }
                                                            </div>
                                                                        TempData["Success"] = "";
                                                                    }

                                                        @if (Convert.ToString(TempData["Failure"]) != "")
                                                        {

                                                            <div class="col-xs-12">

                                                                @{
                                                                    if (Convert.ToString(TempData["Failure"]) != null && Convert.ToString(TempData["Failure"]) != "")
                                                                    {
                                                                        <h5 style="color:red;font-weight:bold;">@Convert.ToString(TempData["Failure"])</h5>
                                                                    }
                                                                }
                                                            </div>
                                                                        TempData["Failure"] = "";
                                                                    }

                                                        <span style="color:#E12F24;">
                                                            <strong>&nbsp;&nbsp;&nbsp;Notes </strong> :
                                                        </span>

                                                        <span>
                                                            1) <span style="color:red;">*</span> - Mandatory &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />
                                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                             @*2) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Enter multiple job numbers for project related activities i.e. Operation – Project Specific, QA Projects.<br />  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E.g. 010101319721, 050101358621
                                                            <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*@
                                                             

                                                        </span>



                                                        @*<div class="row">*@
                                                        <div class="col-xs-12">
                                                            <hr class="custom-hr1">
                                                        </div>
                                                        @*</div>*@

                                                        <div class="col-xs-12 col-sm-6">
                                                            <div class="form-group">
                                                                <label>Cost Centre:</label>
                                                                @Html.TextBoxFor(model => model.ServiceName, new { @placeholder = "Service Code", @class = "form-control", autocomplete = "off", @readonly = "readonly" })
                                                                @Html.ValidationMessageFor(model => model.ServiceName, "", new { @class = "text-danger validation-msg" })
                                                            </div>
                                                        </div>
                                                        @*<div class="col-xs-12 col-sm-6" style="pointer-events:none;">
                                                            <div class="form-group">
                                                                <label>Service Code:</label>
                                                                @if (ViewBag.SubCatlist != null)
                                                                {
                                                                    
                                                                    @Html.DropDownListFor(m => m.ServiceCode, ViewBag.SubCatlist as IEnumerable<SelectListItem>, "--Select Cost center--", new { @class = "form-control", @id = "Pk_CC_Id", })
                                                                    @Html.ValidationMessageFor(model => model.ServiceCode, "", new { @class = "text-danger validation-msg" })
                                                                }
                                                            </div>
                                                        </div>*@
                                                        <div class="col-xs-12 col-sm-6">
                                                            <div class="form-group">
                                                                <label>Activity:</label>
                                                                @if (ViewBag.Activity != null)
                                                                {
                                                                    @Html.DropDownListFor(m => m.ActivityType, ViewBag.Activity as IEnumerable<SelectListItem>, "--Select Activity--", new { @class = "form-control", @id = "PT", @onchange = "onchangeddlStatus(this.value);" })

                                                                    @Html.ValidationMessageFor(model => model.ActivityType, "", new { @class = "text-danger validation-msg" })
                                                                }
                                                                                                                    
                                                            </div>
                                                        </div>

                                                        @if (Model.Id > 0)
                                                        {
                                                            <div class="col-xs-12 col-sm-6" style="pointer-events:none;">
                                                                <div class="form-group">
                                                                    <label>Start Date:</label>

                                                                    @Html.TextBoxFor(model => model.StartDate, "{0:dd MMM yyyy}", htmlAttributes: new { placeholder = "Select Start Date", @class = "form-control form-control-custom StartDate", autocomplete = "off" })
                                                                    @Html.ValidationMessageFor(model => model.StartDate, "", new { @class = "text-danger validation-msg" })
                                                                </div>
                                                            </div>

                                                            <div class="col-xs-12 col-sm-6" style="pointer-events:none;">
                                                                <div class="form-group">
                                                                    <label>End Date:</label>
                                                                    @Html.TextBoxFor(model => model.EndDate, "{0:dd MMM yyyy}", new { @placeholder = "End Date", @class = "form-control form-control-custom EndDate", autocomplete = "off" })
                                                                    @Html.ValidationMessageFor(model => model.EndDate, "", new { @class = "text-danger validation-msg" })
                                                                </div>
                                                            </div>
                                                        }
                                                        else
                                                        {
                                                            <div class="col-xs-12 col-sm-6">
                                                                <div class="form-group">
                                                                    <label>Start Date:</label>

                                                                    @Html.TextBoxFor(model => model.StartDate, "{0:dd MMM yyyy}", htmlAttributes: new { placeholder = "Select Start Date", @class = "form-control form-control-custom StartDate", autocomplete = "off" })
                                                                    @Html.ValidationMessageFor(model => model.StartDate, "", new { @class = "text-danger validation-msg" })
                                                                </div>
                                                            </div>
                                                            <div class="col-xs-12 col-sm-6">
                                                                <div class="form-group">
                                                                    <label>End Date:</label>
                                                                    @Html.TextBoxFor(model => model.EndDate, "{0:dd MMM yyyy}", new { @placeholder = "End Date", @class = "form-control form-control-custom EndDate", autocomplete = "off" })
                                                                    @Html.ValidationMessageFor(model => model.EndDate, "", new { @class = "text-danger validation-msg" })
                                                                </div>
                                                            </div>
                                                        }

                                                       
                                                        <div class="col-xs-12 col-sm-4">
                                                            <div class="form-group">
                                                                <label>Outdoor / On-Site Time (Hrs.):</label>

                                                                @Html.TextBoxFor(model => model.ODTime, htmlAttributes: new { placeholder = "Outdoor / On-Site Time (Hrs.)", @class = "form-control", autocomplete = "off", @OnKeyPress = "return isNumber(event)" })
                                                                @Html.ValidationMessageFor(model => model.ODTime, "", new { @class = "text-danger validation-msg" })
                                                            </div>
                                                        </div>
                                                        <div class="col-xs-12 col-sm-4">
                                                            <div class="form-group">
                                                                <label>Office / Off-Site Time (Hrs.):</label>
                                                                @Html.TextBoxFor(model => model.EndTime, htmlAttributes: new { placeholder = "Office / Off-Site Time (Hrs.)", @class = "form-control", autocomplete = "off", @OnKeyPress = "return isNumber(event)" })
                                                                @Html.ValidationMessageFor(model => model.EndTime, "", new { @class = "text-danger validation-msg" })
                                                            </div>
                                                        </div>

                                                        <div class="col-xs-12 col-sm-4">
                                                            <div class="form-group">
                                                                <label>Travel Time (Hrs.):</label>
                                                                @Html.TextBoxFor(model => model.TravelTime, htmlAttributes: new { placeholder = "Travel Time (Hrs.)", @class = "form-control", autocomplete = "off", @OnKeyPress = "return isNumber(event)" })
                                                                @Html.ValidationMessageFor(model => model.TravelTime, "", new { @class = "text-danger validation-msg" })
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row">

                                                        <div class="col-xs-12 col-sm-4">
                                                            <div class="form-group">
                                                                <label>City/Cities:</label>
                                                                @Html.TextBoxFor(model => model.Location, new { @placeholder = "City/Cities", @class = "form-control" })
                                                                @Html.ValidationMessageFor(model => model.Location, "", new { @class = "text-danger validation-msg" })
                                                            </div>
                                                        </div>
                                                        
                                                        <div class="col-xs-12 col-sm-4">
                                                            <div class="form-group">
                                                                <label id="ControlNo" style="display:none;">TUV India Control No.:</label>
                                                                <label id="ControlNoWithSubJob" style="display:none;">TUV India Control (With Sub Job) No.:</label>
                                                                <span id="ControlSpan" style="color:#ff0000;">*</span>

                                                                @Html.TextBoxFor(model => model.JobNumber, htmlAttributes: new { placeholder = "TUV India Control No.", @class = "form-control", autocomplete = "off", @id = "JobNumber" })
                                                                @Html.ValidationMessageFor(model => model.JobNumber, "", new { @class = "text-danger validation-msg" })
                                                            </div>
                                                        </div>

                                                        @*<div class="col-xs-12 col-sm-4" id="ControlNoWithSubJob" style="display:none;">
                                                            <div class="form-group">
                                                                <label>TUV India Control (With Sub Job) No.:</label><span style="color:#ff0000;">*</span>

                                                                @Html.TextBoxFor(model => model.JobNumber, htmlAttributes: new { placeholder = "TUV India Control (With Sub Job) No.", @class = "form-control", autocomplete = "off",@id="JobNumbersub" })
                                                                @Html.ValidationMessageFor(model => model.JobNumber, "", new { @class = "text-danger validation-msg" })
                                                            </div>
                                                        </div>*@

                                                        <div class="col-xs-12 col-sm-4" id="callNo" style="display:none;">
                                                            <div class="form-group">
                                                                <label>Tiimes Call Number of Inspector.:</label><span style="color:#1C3DE3">*</span>

                                                                @Html.TextBoxFor(model => model.CallNumber, htmlAttributes: new { placeholder = "Call Number", @class = "form-control", autocomplete = "off", @id = "txtCallNumber", onchange = "CheckValidCall()" })
                                                                @Html.ValidationMessageFor(model => model.CallNumber, "", new { @class = "text-danger validation-msg" })
                                                            </div>
                                                        </div>


                                                    </div>
                                                   
                                                    <div class="row" id="NewCust">
                                                        <div class="col-xs-12 col-sm-4">
                                                            <div class="form-group " id="DivExisting" >
                                                                <label>Customer Type <span style="color:red">*</span> : </label>

                                                                @Html.RadioButtonFor(m => m.NewExistingCustomer, "New", new { id = "New" })
                                                                <label for="Active">New</label>
                                                                @Html.RadioButtonFor(m => m.NewExistingCustomer, "Existing", new { id = "Existing", @checked = "checked" })
                                                                <label for="InActive">Existing</label>
                                                            </div>
                                                        </div>

                                                        <div class="col-xs-12 col-sm-4">
                                                            <div class="form-group">

                                                                @Html.RadioButtonFor(m => m.DomesticInternationVisit, "Domestic", new { id = "Domestic" })
                                                                <label for="Active">Domestic</label>
                                                                @Html.RadioButtonFor(m => m.DomesticInternationVisit, "International", new { id = "InternationVisit" })
                                                                <label for="InActive">International</label>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-xs-12 col-sm-8">
                                                            <div class="form-group">
                                                                <label>Description of Activity:</label>
                                                                @Html.TextAreaFor(model => model.Description, htmlAttributes: new { placeholder = "Description of Activity", @class = "form-control form-control-custom ", autocomplete = "off", @rows = "5" })
                                                                @Html.ValidationMessageFor(model => model.Description, "", new { @class = "text-danger validation-msg" })
                                                            </div>
                                                        </div>

                                                    </div>
                                                    <div class="col-xs-12 col-sm-4" hidden>
                                                        <div class="form-group">
                                                            <label>Attachments:</label>
                                                            @*<input type="file"  class="inputupload" name="Image" id="img_Banner" multiple="multiple" />*@
                                                            <input type="file" class="inputupload" name="Image" id="img_Banner" multiple="multiple" />
                                                            @Html.HiddenFor(m => m.Attachment)
                                                            @if (Model != null && Model.Attachment != null && Model.Attachment != "")
                                                            {
                                                                string[] words = (Model.Attachment).Split(',');
                                                                for (int j = 1; j < words.Count(); j++)
                                                                {
                                                                    <a target="_blank" href="@Url.Content("~/NonInspectionActivityDocument/" + words[j-1])">
                                                                        @*<img src="~/PDF-Icon.png" width="50" height="50" />*@
                                                                        <span>@words[j - 1].ToString()</span>
                                                                    </a>
                                                                        @*<img src="@Url.Content("~/Content/JobDocument/" + words[j-1])" width="50" height="50" />*@
                                                                }
                                                            }
                                                        </div>
                                                    </div>





                                                            <div class="row">

                                                                <div class="col-xs-12 col-sm-4">

                                                                    <div class="form-group">

                                                                        <button type="submit" class="btn btn-default insert-form-btn" id="btnAddFl"> Save </button>
                                                                        @*<button type="button" class="btn btn-default insert-form-btn" id="ddlInspectionLocation"> Expense</button>*@


                                                                    </div>
                                                                </div>

                                                            </div>




                                                            <div class="row">
                                                                <div class="col-xs-12">
                                                                    <hr class="custom-hr1">
                                                                </div>
                                                            </div>
</form>



                                                @*}*@
                                                @using (Html.BeginForm("ListNonInspectionActivity", "NonInspectionActivity", FormMethod.Post, new { enctype = "multipart/form-data", @id = "form1" }))
                                                {




                                                    <div class="row">
                                                        @*<div class="col-xs-12 col-sm-offset-1 col-sm-10">*@
                                                        <div>
                                                            <div class="form-box">
                                                                <form>



                                                                    <div class="row">
                                                                        <div class="col-xs-12" style="text-align:center;">
                                                                            <h4><label>Records</label></h4>
                                                                        </div>
                                                                    </div>
                                                                    <div class="row">
                                                                        <div class="col-xs-4">
                                                                            <div class="form-group">
                                                                                <label>From Date:</label>
                                                                                @Html.TextBoxFor(model => model.FromD, "{0:dd MMM yyyy}", htmlAttributes: new { placeholder = "Select Start Date", @class = "form-control form-control-custom FromD", autocomplete = "off" })
                                                                                @Html.ValidationMessageFor(model => model.FromD, "", new { @class = "text-danger validation-msg" })
                                                                            </div>
                                                                        </div>


                                                                        <div class="col-xs-4">
                                                                            <div class="form-group">
                                                                                <label>To Date:</label>
                                                                                @Html.TextBoxFor(model => model.ToD, "{0:dd MMM yyyy}", htmlAttributes: new { placeholder = "Select To Date", @class = "form-control form-control-custom ToD", autocomplete = "off" })
                                                                                @Html.ValidationMessageFor(model => model.ToD, "", new { @class = "text-danger validation-msg" })
                                                                            </div>

                                                                        </div>

                                                                        <div class="col-xs-2">
                                                                            <div class="form-group">
                                                                                @*<label>Search:</label>*@<br />
                                                                                <input type="submit" value="Search" class="btn btn-default insert-form-btn" style="margin-top:3px" />
                                                                            </div>

                                                                        </div>
                                                                        <div class="col-xs-2">
                                                                            <div class="form-group">
                                                                                <br />
                                                                                <button type="button" value="ExportToExcel" class="btn btn-default insert-form-btn" onclick="location.href='@Url.Action("ExportIndex","NonInspectionActivity")'"
                                                                                        style="border:none;margin-top:0px;margin-top:3px;">
                                                                                    Export To Excel
                                                                                </button>

                                                                            </div>
                                                                        </div>
                                                                    </div>



                                                                    <div class="col-xs-12">
                                                                        <table class="display dataTable no-footer" style="overflow-y:auto;width: 1121px;margin-left:-100px" id="gridMapping" onpageindexchanged="gridMapping_PageIndexChanged">
                                                                            <tr>
                                                                                <td>
                                                                                    @(Html
                                                                                        .Grid(Model.NIADashBoard)
                                                                                        .Build(columns =>
                                                                                        {
                                                                                            columns.Add().Titled("Add Expenses").RenderedAs(c => CustomRenderingOfColumnExpense(c)).Sortable(true);
                                                                                            columns.Add().Titled("Edit/Delete").RenderedAs(c => CustomRenderingOfColumn(c)).Sortable(true);
                                                                                            columns.Add(c => c.DateSE).Titled("Date");
                                                                                            columns.Add(c => c.ActivityTypeName).Titled("Activity");
    
                                                                                            columns.Add(c => c.StartTime).Titled("Outdoor / On-Site Time (Hrs.)");
                                                                                            columns.Add(c => c.EndTime).Titled("Office / Off-Site Time (Hrs.)");
                                                                                            columns.Add(c => c.TravelTime).Titled("Travel Time (Hrs.)");
                                                                                            columns.Add(c => c.Location).Titled("City/Cities");
                                                                                            columns.Add(c => c.Description).Titled("Description of Activity");
                                                                                            columns.Add(c => c.ServiceCode).Titled("Service Code");
                                                                                            columns.Add(c => c.NewExistingCustomer).Titled("Customer Type1").Css("grdSAPWidth");
                                                                                            columns.Add(c => c.DomesticInternationVisit).Titled("Customer Type2").Css("grdSAPWidth");
                                                                                            columns.Add(c => c.Id).Titled("ID");
                                                                                           // columns.Add().Titled("Attchments").RenderedAs(c => CustomRenderingOfColumnAttachment(c)).Sortable(true);
                                                                                            columns.Add(c => c.JobNumber).Titled("TUVI Control No.");
                                                                                            columns.Add(c => c.SAP_No).Titled("SAP Number").Css("grdSAPWidth");
    


                                                                                        })
                                                                                        .Pageable(pager =>
                                                                                        {
                                                                                            //pager.PageSizes = new DictionaryInt32, String > { { 0, "All" }, { 2, "2" }, { 4, "4" } };
                                                                                            pager.ShowPageSizes = true;
                                                                                            pager.PagesToDisplay = 3;
                                                                                            pager.CurrentPage = 1;
                                                                                            pager.RowsPerPage = 15;
   
                                                                                        })
                                                                                        .UsingFilterMode(GridFilterMode.Row)
                                                                                        .Empty("No Data Found")
                                                                                        .Filterable()
                                                                                        .Sortable()

                                                                                    )
                                                                                </td>
                                                                            </tr>
                                                                        </table>

                                                                    </div>


                                                                    <div class="modal" id="myModal">
                                                                        <div class="modal-dialog">
                                                                            <div class="modal-content">


                                                                                <div class="modal-header">
                                                                                    <button type="button" class="close NO" data-dismiss="modal">&times;</button>
                                                                                </div>
                                                                                <div class="modal-body">
                                                                                    Do you want to Add Expense and Trip Segment?
                                                                                </div>

                                                                                <!-- Modal footer -->
                                                                                <div class="modal-footer">
                                                                                    @*<a href="@Url.Action("VisitReportForm", "VisitReport", new {@PK_Call_ID = Model.PK_Call_ID })" class="btn btn-danger" style="background-color:green;" title="Edit">Yes</a>*@
                                                                                    <a href="@Url.Action("CreateExpenseItem", "ExpenseItem", new { FKId = Model.Id,Type="NIA" ,SubJobNo=Model.JobNumber,PK_Call_Id=Model.PK_Call_ID })" class="btn btn-danger" style="background-color:green;" title="Edit">Add Expense</a>
                                                                                    <a href="@Url.Action("CreateTripSegment", "TripSegment", new { FKId = Model.Id,Type="NIA" ,SubJobNo=Model.JobNumber,PK_Call_Id=Model.PK_Call_ID  })" class="btn btn-danger" style="background-color:green;" title="Edit">Add Trip Segment</a>

                                                                                    <button type="button" class="btn btn-danger NO" data-dismiss="modal">No</button>
                                                                                </div>

                                                                            </div>
                                                                        </div>
                                                                    </div>



                                                                </form>
                                                            </div>
                                                        </div>
                                                    </div>

                                                }

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

}



<script>
    $("#btnAddFl").click(function myfunction() {
        debugger;
        if (validateform() == false) {
            return false;
        }
        else {
            $("#form1").submit();
        }
    });

    function validateform()
    {
        debugger;

      //  alert($("#PT Option:selected").val());

        var ActivityType = $("#PT").val();
        var STDate = $("#StartDate").val();
        var ENDate = $("#EndDate").val();

        var Location = $("#Location").val();
        var Description = $("#Description").val();


        var JN = $("#JobNumber").val();
        //var JNSub = $("#JobNumbersub").val();
        
        var TT = parseInt($("#TravelTime").val());// $("#TravelTime").val();
        var ODT = $("#ODTime").val();
        var ET = $("#EndTime").val();

        var Call = $("#txtCallNumber").val();
        var Rating = $("#IdRating").val();

        var NewExistingCustomer = $("input[type='radio'][name='NewExistingCustomer']:checked").val();
        var DomesticInternationVisit = $("input[type='radio'][name='DomesticInternationVisit']:checked").val();

        var Id = $("#Id").val();

       // var StartTime = $("#txtCallNumber").val();
        var TravelTime = $("#TravelTime").val();

        
        if (0 <= parseInt(ODT) && parseInt(ODT) <= 16) {

        }
        else {
            alert("Please select OD Time between 0 to 16!");
            $("#ODTime").focus()
            return false;
        }
        if (0 <= parseInt(ET) && parseInt(ET) <= 16) {

        }
        else {
            alert("Please select Office Time between 0 to 16!");
            $("#EndTime").focus()
            return false;
        }
        if (0 <= parseInt(TT) && parseInt(TT) <= 8) {

        }
        else {
            alert("Please select Travel Time between 0 to 8!");
            $("#TravelTime").focus()
            return false;
        }
        if (parseInt(ODT) == 0 && parseInt(TT) == 0 && parseInt(ET) == 0) {
            alert("At least one Value should be more than 0!");
            $("#ODTime").focus()
            return false;
        }


        if (Id > 0)
        {

        }
        else
        {
            if (STDate == "" || STDate == null) {
                alert("Please select Start Date !");
                $("#StartDate").focus()
                return false;
            }
            else
            {

            }

            if (ENDate == "" || ENDate == null) {
                alert("Please select End  Date !");
                $("#EndDate").focus()
                return false;
            }
            else
            {

            }
        }





       

        if (($("#PT Option:selected").val() == ""))
        {
            alert("Please Select Activity Type !");
            $("#PT").focus()
            return false;
        }
        
        //if (($("#PT Option:selected").val() == "29") && (JN == "" || JN == null)) {
        if (($("#PT Option:selected").val() == "25") && (JN == "" || JN == null)) {
            alert("Please Enter Sub Job Number !");
            $("#JobNumber").focus()
            return false;
        }

        //if (($("#PT Option:selected").val() == "41") && (JN == "" || JN == null)) {
        if (($("#PT Option:selected").val() == "37") && (JN == "" || JN == null)) {
            alert("Please Enter Sub Job Number !");
            $("#JobNumber").focus()
            return false;
        }

        //if (($("#PT Option:selected").val() == "30") && (JN == "" || JN == null)) {
        if (($("#PT Option:selected").val() == "26") && (JN == "" || JN == null)) {
            alert("Please Enter Sub Job Number !");
            $("#JobNumber").focus()
            return false;
        }
        //if (($("#PT Option:selected").val() == "10") && (JN == "" || JN == null)) {
        if (($("#PT Option:selected").val() == "06") && (JN == "" || JN == null)) {
            alert("Please Enter Job Number !");
            $("#JobNumber").focus()
            return false;
        }

        //if (($("#PT Option:selected").val() == "20") && (JN == "" || JN == null)) {
        if (($("#PT Option:selected").val() == "16") && (JN == "" || JN == null)) {
            alert("Please Enter Job Number !");
            $("#JobNumber").focus()
            return false;
        }

        //if (($("#PT Option:selected").val() == "11") && (JN == "" || JN == null)) {
        if (($("#PT Option:selected").val() == "07") && (JN == "" || JN == null)) {
            alert("Please Enter Job Number with Sub Job No !");
            $("#JobNumber").focus()
            return false;
        }
        //if (($("#PT Option:selected").val() == "22") && (JNSub == "" || JNSub == null)) {
        if (($("#PT Option:selected").val() == "18") && (JNSub == "" || JNSub == null)) {
            alert("Please Enter Job Number with Sub Job No !");
            $("#JobNumber").focus()
            return false;
        }

        //  var LeaveFile = $("[name='img_Banner']").val();
        var LeaveFile = $("#img_Banner").val();        

        //if (($("#PT Option:selected").val() == "5") && (NewExistingCustomer == "" || NewExistingCustomer == null)) {
        if (($("#PT Option:selected").val() == "01") && (NewExistingCustomer == "" || NewExistingCustomer == null)) {
            alert("Select Customer Type!");
            $("#NewExistingCustomer").focus()
            return false;
        }
        //if (($("#PT Option:selected").val() == "5") && (DomesticInternationVisit == "" || DomesticInternationVisit == null)) {
        if (($("#PT Option:selected").val() == "01") && (DomesticInternationVisit == "" || DomesticInternationVisit == null)) {
            alert("Select Customer Type!");
            $("#DomesticInternationVisit").focus()
            return false;
        }


        //if (($("#PT Option:selected").val() == "6") && (NewExistingCustomer == "" || NewExistingCustomer == null)) {
        if (($("#PT Option:selected").val() == "02") && (NewExistingCustomer == "" || NewExistingCustomer == null)) {
            alert("Select Customer Type!");
            $("#NewExistingCustomer").focus()
            return false;
        }
        //if (($("#PT Option:selected").val() == "6") && (DomesticInternationVisit == "" || DomesticInternationVisit == null)) {
        if (($("#PT Option:selected").val() == "02") && (DomesticInternationVisit == "" || DomesticInternationVisit == null)) {
            alert("Select Customer Type!");
            $("#DomesticInternationVisit").focus()
            return false;
        }
        /*
        if (($("#PT Option:selected").val() == "10") && (NewExistingCustomer == "" || NewExistingCustomer == null)) {
            alert("Select Customer Type!");
            $("#NewExistingCustomer").focus()
            return false;
        }
        if (($("#PT Option:selected").val() == "10") && (DomesticInternationVisit == "" || DomesticInternationVisit == null)) {
            alert("Select Customer Type!");
            $("#DomesticInternationVisit").focus()
            return false;
        }
        */

        //if (($("#PT Option:selected").val() == "31") && (NewExistingCustomer == "" || NewExistingCustomer == null)) {
        if (($("#PT Option:selected").val() == "27") && (NewExistingCustomer == "" || NewExistingCustomer == null)) {
            alert("Select Customer Type!");
            $("#NewExistingCustomer").focus()
            return false;
        }

        //if (($("#PT Option:selected").val() == "31") && (DomesticInternationVisit == "" || DomesticInternationVisit == null)) {
        if (($("#PT Option:selected").val() == "27") && (DomesticInternationVisit == "" || DomesticInternationVisit == null)) {
            alert("Select Customer Type!");
            $("#DomesticInternationVisit").focus()
            return false;
        }

        if (($("#PT Option:selected").val() == "31") && (NewExistingCustomer == "" || NewExistingCustomer == null)) {
            alert("Select Customer Type!");
            $("#NewExistingCustomer").focus()
            return false;
        }

        if (($("#PT Option:selected").val() == "31") && (DomesticInternationVisit == "" || DomesticInternationVisit == null)) {
            alert("Select Customer Type!");
            $("#DomesticInternationVisit").focus()
            return false;
        }
        if (($("#PT Option:selected").val() == "32") && (NewExistingCustomer == "" || NewExistingCustomer == null)) {
            alert("Select Customer Type!");
            $("#NewExistingCustomer").focus()
            return false;
        }

        if (($("#PT Option:selected").val() == "32") && (DomesticInternationVisit == "" || DomesticInternationVisit == null)) {
            alert("Select Customer Type!");
            $("#DomesticInternationVisit").focus()
            return false;
        }
        if (($("#PT Option:selected").val() == "34") && (NewExistingCustomer == "" || NewExistingCustomer == null)) {
            alert("Select Customer Type!");
            $("#NewExistingCustomer").focus()
            return false;
        }

        if (($("#PT Option:selected").val() == "34") && (DomesticInternationVisit == "" || DomesticInternationVisit == null)) {
            alert("Select Customer Type!");
            $("#DomesticInternationVisit").focus()
            return false;
        }
        if (($("#PT Option:selected").val() == "30") && (NewExistingCustomer == "" || NewExistingCustomer == null)) {
            alert("Select Customer Type!");
            $("#NewExistingCustomer").focus()
            return false;
        }

        if (($("#PT Option:selected").val() == "30") && (DomesticInternationVisit == "" || DomesticInternationVisit == null)) {
            alert("Select Customer Type!");
            $("#DomesticInternationVisit").focus()
            return false;
        }
        //if (($("#PT Option:selected").val() == "28") && (NewExistingCustomer == "" || NewExistingCustomer == null)) {
        //    alert("Select Customer Type!");
        //    $("#NewExistingCustomer").focus()
        //    return false;
        //}

        //if (($("#PT Option:selected").val() == "28") && (DomesticInternationVisit == "" || DomesticInternationVisit == null)) {
        //    alert("Select Customer Type!");
        //    $("#DomesticInternationVisit").focus()
        //    return false;
        //}



        //if (($("#PT Option:selected").val() == "7") || ($("#PT Option:selected").val() == "31"))
        if (($("#PT Option:selected").val() == "03") || ($("#PT Option:selected").val() == "27"))
        {
            $("#Existing").prop("checked", true);

            //if(($("#PT Option:selected").val() == "7"))
            if (($("#PT Option:selected").val() == "03"))
            {
                $("#Existing").prop("readonly", "readonly");
                var DL = document.getElementById("DivExisting");
                DL.className += " addCSS";
                
            }
            
         
        }
        else {
            
            $("#DivExisting").removeClass("addCSS");
        }

        //if (($("#PT Option:selected").val() == "7") && (DomesticInternationVisit == "" || DomesticInternationVisit == null)) {
        if (($("#PT Option:selected").val() == "03") && (DomesticInternationVisit == "" || DomesticInternationVisit == null)) {
            alert("Select Customer Type!");
            $("#DomesticInternationVisit").focus()
            return false;
        }

        if (TravelTime=="" || TravelTime==null)
        {
            alert("Select Travel Time!");
            $("#TravelTime").focus()
            return false;
        }
        if (Location == "" || Location == null) {
            alert("Select Location!");
            $("#Location").focus()
            return false;
        }
        if (Description == "" || Description == null) {
            alert("Select Description!");
            $("#Description").focus()
            return false;
        }



    }

</script>

<script type="text/javascript">
    function onchangeddlStatus(val)
    {
        debugger;
        
        $('#txtCallNumber').hide();
        $('#callNo').hide();
        $('#idR').hide();
        $('#NewCust').hide();

        VisiblityOfControlNo(val)

        $('#JobNumber').val('');
        // $('#JobNumbersub').val('');


        //if (val == "5" || val == "6" || val == "7" || val == "31" || val == "34" || val == "35" || val == "36" || val == "38")
        if (val == "01" || val == "02" || val == "03" || val == "27" || val == "30" || val == "31" || val == "32" || val == "34")
        {
            $('#NewCust').show();
            //if (val == "7" || val == "31")
            if (val == "03" || val == "27")
            {
                $("#Existing").prop("checked", true);

                //if(val=="7")
                if (val == "03")
                {
                    $("#Existing").prop("readonly", "readonly");
                    var DL = document.getElementById("DivExisting");
                    DL.className += " addCSS";
                    
                }
               

            }
            else {
               
                $("#DivExisting").removeClass("addCSS");
            }
        }       
        else
        {
            $('input[name="NewExistingCustomer"]').attr('checked', false);
            $('input[name="DomesticInternationVisit"]').attr('checked', false);
            $('#NewCust').hide();
            
            $("#DivExisting").removeClass("addCSS");
        
        }


    }


    $(document).ready(function ()
    {

        debugger;
        var val = $("#PT Option:selected").val();
        
        
       

        $('#txtCallNumber').hide();
        $('#callNo').hide();
        $('#idR').hide();
        $('#NewCust').hide();

        VisiblityOfControlNo(val)

        
        //if (val == "5" || val == "6" || val == "7" || val == "31" || val == "34" || val == "35" || val == "36" || val == "38")
        if (val == "01" || val == "02" || val == "03" || val == "27" || val == "30" || val == "31" || val == "32" || val == "34")
        {
            $('#NewCust').show();
            //if (val == "7" || val=="31")
            if (val == "03" || val == "27")
            {

                $("#Existing").prop("checked", true);
                //if (val == "7") {
                    if (val == "03") {
                    $("#Existing").prop("readonly", "readonly");
                    var DL = document.getElementById("DivExisting");
                    DL.className += " addCSS";
                }
               
            }
            else {
                
                $("#DivExisting").removeClass("addCSS");
            }
        }
        else {
            $('input[name="NewExistingCustomer"]').attr('checked', false);
            $('input[name="DomesticInternationVisit"]').attr('checked', false);
            $('#NewCust').hide();
          
            $("#DivExisting").removeClass("addCSS");
        }
    });


 

    function VisiblityOfControlNo(val2)
    {       

        //if (val2 == "29" || val2 == "11" || val2 == "22" || val2 == "32" || val2 == "31" || val2 == "41")
        if (val2 == "25" || val2 == "07" || val2 == "18" || val2 == "28" || val2 == "27" || val2 == "37")
        {
            /// single Sub Job Number

            $('#ControlNo').hide();
            $('#ControlNoWithSubJob').show();
            $('#JobNumber').show();
            $('#ControlSpan').show();          
        }       
        //else if (val2 == "10" || val2 == "20")
        else if (val2 == "06" || val2 == "16")
        {
            //control no with sub job
            $('#ControlNo').show();
            $('#ControlNoWithSubJob').hide();
            $('#JobNumber').show();
            $('#ControlSpan').show();
        }        
        else
        {
            $('#ControlNo').hide();
            $('#ControlNoWithSubJob').hide();
            $('#JobNumber').hide();
            $('#ControlSpan').hide();
        }
    }

</script>


<script>
    function isNumber(evt) {
        evt = (evt) ? evt : window.event;
        //  alert(evt.keyCode);
        var charCode = (evt.which) ? evt.which : evt.keyCode;


        if ((charCode > 31 && (charCode < 48 || charCode > 57)) && (charcode != 46)) {
            return false;
        }
        return true;
    }
</script>

<script>
    $(document).ready(function ()
    {
        $("#JobNumber").focusout(function ()
        {

            var JobNoAS = $("#JobNumber").val();
            var ActivityType = $("#PT").val();
           // alert(ActivityType);
            if (JobNoAS != '')
            {
                $.post("@Url.Action("ValidateJob", "NonInspectionActivity")",
                {
                    JobNo: $("#JobNumber").val(),
                    ActType: $("#PT").val()

                },
                function (data)
                {
                    if (data == 0)
                    {
                        alert("Job No does not exist !");
                        $("#JobNumber").val("");
                        return false;
                    }
                }
                );
            }

        });

    });
</script>


@*...Calender Control...*@
<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
<script src="//code.jquery.com/jquery-1.10.2.js"></script>
<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>

<script>
    $(function () {
        $(".StartDate").datepicker({
            dateFormat: 'dd/mm/yy',//check change
            changeMonth: true,
            changeYear: true,
            yearRange: "-100:+50"
        });
    });
</script>

<script>
    $(function () {
        $(".EndDate").datepicker({
            dateFormat: 'dd/mm/yy',//check change
            changeMonth: true,
            changeYear: true,
            yearRange: "-100:+50"
        });
    });
</script>

@*Date Picker for From Date*@

<script>
    $(function () {
        $(".FromD").datepicker({
            dateFormat: 'dd/mm/yy',//check change
            changeMonth: true,
            changeYear: true,
            yearRange: "-100:+50"
        });
    });
</script>

<script>
    $(function () {
        $(".ToD").datepicker({
            dateFormat: 'dd/mm/yy',//check change
            changeMonth: true,
            changeYear: true,
            yearRange: "-100:+50"
        });
    });
</script>

<script>
    function CheckValidCall() {
            debugger;
        // $("#Status").html('<font color="blue">Checking ...</font>'),
            
            $.post("@Url.Action("CheckValidCall", "NonInspectionActivity")",
                {
                    companyname: $("#txtCallNumber").val()
                },
                function (data) {
                    debugger;
                    if (data == 0) {

                        alert("Call Number is not Valid.")
                        $("#txtCallNumber").val("");

                        //$("#Status").html('<font color="red">Coupan Code is  already Use !</font>');
                    }
                    if (data == 1) {




                    }



                });


        }
</script>

<script>
           [].forEach.call(document.getElementsByClassName('mvc-grid'), function (element) {
               new MvcGrid(element);
           });
</script>

<script>
    var CustomTextFilter = (function (base) {
        MvcGridExtends(CustomTextFilter, base);

        function CustomTextFilter(column) {
            base.call(this, column);

            this.methods = ['contains'];
            column.grid.lang.custom = { contains: 'Contains' };
        }

        // Other extension points can be found at MvcGridFilter declaration

        return CustomTextFilter;
    })(MvcGridFilter);

    new MvcGrid(document.querySelector('.mvc-grid'), {
        filters: {
            'custom': CustomTextFilter
        }
    });
</script>

<script>
    $(document).ready(function () {
        $('#ddlInspectionLocation').on('click', function () {
            debugger;
            $('#myModal').show();
        });
    });
</script>

<script>
    $(document).ready(function () {
        $('.NO').click('change', function () {

            $('#myModal').hide();
        });
    });
</script>

<script>
    $(document).ready(function () {
        debugger;
        var AddExpense = $("#AddExpense").val();
        if(AddExpense=="Yes")
        {

            //var button = document.getElementById("ddlInspectionLocation");
            //button.Click();
            $('#myModal').show();
        }
        else
        {

        }


    });
</script>
