@model TuvVision.Models.SafetyInsidentReport
@{
    ViewBag.Title = "SafetyInsidentReport";
    Layout = "~/Views/Shared/_TuvVision.cshtml";
}

@*...Calender Control...*@
<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
<script src="//code.jquery.com/jquery-1.10.2.js"></script>
<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>


<!--filepond-->
<link href="~/AllJsAndCss/css/filepond.css" rel="stylesheet" />


<style>
    .ui-widget-header {
        background: #001ED2 !important;
    }

    .ui-datepicker-month, .ui-datepicker-year {
        color: #333 !important;
    }
    /*-- Delete color-profile --*/
    ul.Attachment {
        padding-left: 0px;
        list-style: none;
        margin-bottom: 0px;
    }

        ul.Attachment > li {
            border: 1px solid #999;
            margin: 7px 5px 0 0;
            display: inline-block;
            padding: 0px 10px;
            background-color: #dfdfdf;
            color: #000;
        }

            ul.Attachment > li a.title {
                color: #000;
                vertical-align: text-bottom;
                text-transform: capitalize;
            }

            ul.Attachment > li a.deleteItem {
                color: white;
                font-size: 10px;
                background: #e91e1e;
                padding: 2px 4px;
                border-radius: 50%;
                vertical-align: text-top;
            }
    /*EndCode*/
    /*-- Delete color-profile --*/
    ul.AttachmentFormat {
        padding-left: 0px;
        list-style: none;
        margin-bottom: 0px;
    }

        ul.AttachmentFormat > li {
            border: 1px solid #999;
            margin: 7px 5px 0 0;
            display: inline-block;
            padding: 0px 10px;
            background-color: #dfdfdf;
            color: #000;
        }

            ul.AttachmentFormat > li a.title1 {
                color: #000;
                vertical-align: text-bottom;
                text-transform: capitalize;
            }

            ul.AttachmentFormat > li a.deleteItemFormat {
                color: white;
                font-size: 10px;
                background: #e91e1e;
                padding: 2px 4px;
                border-radius: 50%;
                vertical-align: text-top;
            }
    /*EndCode*/
</style>

<script>

    $(function () {
        $(".DateOfReport").datepicker({
            dateFormat: 'dd/mm/yy',//check change
            changeMonth: true,
            changeYear: true,
            yearRange: "-100:+50"
        });
    });
</script>
<script>
    $(function () {
        $(".DateOfIncident").datepicker({
            dateFormat: 'dd/mm/yy',//check change
            changeMonth: true,
            changeYear: true,
            yearRange: "-100:+50"
        });
    });
</script>

@Html.HiddenFor(m => m.PKId)

<div class="main-content3 xs-max-height grey-bg-f3">
    <div class="grey-bg-f3">
        <!--Start of header-->
        <div class="container-fluid">
            <div class="row assignfixedwidth rp-5">

                <div class="col-xs-12 form-col">
                    <div class="row">

                        <div class="col-xs-12 text-right">
                            <a href="@Url.Action("ListNCR", "SafetyInsidentReport")" class="btn btn-info dynamic-function-btn"><i class="fa fa-long-arrow-left"></i> Go Back</a>

                        </div>

                        <div class="col-xs-12">
                            <div class="white-bg section-box-shadow">
                                <h3 class="form-page-title">Safety Incident Report F-MR-35 Rev. 01, Effective from Sept 22</h3>
                                <div class="row">
                                    <div class="col-xs-12 col-sm-offset-1 col-sm-10">
                                        <div class="form-box">
                                            <form method="post" enctype="multipart/form-data">

                                                <div class="row">

                                                    <div class="col-xs-12 col-sm-4">
                                                        <div class="form-group">
                                                            <label>TIIMES UIN: </label>
                                                            @Html.TextBoxFor(model => model.TiimesUIN, htmlAttributes: new { placeholder = "Tiimes UIN", @class = "form-control", autocomplete = "off" })


                                                            @Html.ValidationMessageFor(model => model.TiimesUIN, "", new { @class = "text-danger validation-msg" })

                                                        </div>

                                                    </div>

                                                    <div class="col-xs-12 col-sm-4">
                                                        <div class="form-group">
                                                            <label>Branch: </label>
                                                            @if (ViewBag.SubCatlist != null)
                                                            {
                                                                @Html.DropDownListFor(m => m.Branch, ViewBag.SubCatlist as IEnumerable<SelectListItem>, "--Select Branch--", new { @class = "form-control", @disabled = "disabled" })
                                                                @Html.HiddenFor(m => m.Branch)
                                                            }
                                                            @Html.ValidationMessageFor(model => model.Branch, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="row">



                                                    <div class="col-xs-12 col-sm-4">
                                                        <div class="form-group">
                                                            <label>Date of Report: </label>
                                                            @*@Html.TextBoxFor(model => model.DateofReport, new { @placeholder = "Date of Report", @class = "form-control", autocomplete = "off" })*@
                                                            @Html.TextBoxFor(model => model.DateofReport, "{0:dd MMM yyyy}", htmlAttributes: new { placeholder = "Date of Report", @class = "form-control DateOfReport", autocomplete = "off"})


                                                            @Html.ValidationMessageFor(model => model.DateofReport, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>

                                                    <div class="col-xs-12 col-sm-4">
                                                        <div class="form-group">
                                                            <label>Date Of Incident: </label>
                                                            @Html.TextBoxFor(model => model.DateOfIncident, new { @placeholder = "Date Of Incident", @class = "form-control DateOfIncident", autocomplete = "off" })
                                                            @Html.ValidationMessageFor(model => model.DateOfIncident, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>

                                                    <div class="col-xs-12 col-sm-4">
                                                        <div class="form-group">
                                                            <label>Type Of Incident: </label>
                                                            @Html.TextBoxFor(model => model.TypeOfIncident, new { @placeholder = "Type Of Incident", @class = "form-control", autocomplete = "off" })
                                                            @Html.ValidationMessageFor(model => model.TypeOfIncident, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="row">

                                                    <div class="col-xs-12 col-sm-4">
                                                        <div class="form-group">
                                                            <label>Name Of Injured Person: </label>
                                                            @*@Html.TextBoxFor(model => model.NameOfInjuredPerson, new { @placeholder = "Name Of Injured Person", @class = "form-control", autocomplete = "off" })*@
                                                            @Html.DropDownListFor(m => m.NameOfInjuredPerson, ViewBag.Userlist as IEnumerable<SelectListItem>, "--Select Inspector--", new { @class = "form-control", id = 'a', @disabled = "disabled" })
                                                            @Html.ValidationMessageFor(model => model.NameOfInjuredPerson, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>

                                                    <div class="col-xs-12 col-sm-4">
                                                        <div class="form-group">
                                                            <label>IPHome Address: </label>
                                                            @Html.TextBoxFor(model => model.IPHomeAddress, new { @placeholder = "IPHome Address", @class = "form-control", autocomplete = "off" })
                                                            @Html.ValidationMessageFor(model => model.IPHomeAddress, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>

                                                    <div class="col-xs-12 col-sm-4">
                                                        <div class="form-group">
                                                            <label>Location of Incident: </label>
                                                            @Html.TextBoxFor(model => model.LocationofIncident, new { @placeholder = "Location of Incident", @class = "form-control", autocomplete = "off" })
                                                            @Html.ValidationMessageFor(model => model.LocationofIncident, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">


                                                    <div class="col-xs-12 col-sm-6">
                                                        <div class="form-group">
                                                            <label>Type Of Injury: </label>
                                                            @Html.TextBoxFor(model => model.TypeOfInjury, new { @placeholder = "Type Of Injury", @class = "form-control", autocomplete = "off" })
                                                            @Html.ValidationMessageFor(model => model.TypeOfInjury, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>

                                                    <div class="col-xs-12 col-sm-6">
                                                        <div class="form-group">
                                                            <label>Medical Treatment Details: </label>
                                                            @Html.TextBoxFor(model => model.MedicalTreatmentDetails, new { @placeholder = "Medical Treatment Details", @class = "form-control", autocomplete = "off" })
                                                            @Html.ValidationMessageFor(model => model.MedicalTreatmentDetails, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>

                                                </div>





                                                <div class="row">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <div class="form-group">
                                                            <label>Description Of Incident: </label>
                                                            @Html.TextAreaFor(model => model.DescriptionOfIncident, new { @placeholder = "Description Of Incident", @class = "form-control", autocomplete = "off" })
                                                            @Html.ValidationMessageFor(model => model.DescriptionOfIncident, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>

                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <div class="form-group">
                                                            <label>Root Cause Analysis: </label>
                                                            @Html.TextAreaFor(model => model.RootCauseAnalysis, new { @placeholder = "Root Cause Analysis", @class = "form-control", autocomplete = "off" })
                                                            @Html.ValidationMessageFor(model => model.RootCauseAnalysis, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <div class="form-group">
                                                            <label>Correction: </label>
                                                            @Html.TextAreaFor(model => model.Correction, new { @placeholder = "Correction", @class = "form-control", autocomplete = "off" })
                                                            @Html.ValidationMessageFor(model => model.Correction, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <div class="form-group">
                                                            <label>Corrective Action: </label>
                                                            @Html.TextAreaFor(model => model.CorrectiveAction, new { @placeholder = "Corrective Action", @class = "form-control", autocomplete = "off" })
                                                            @Html.ValidationMessageFor(model => model.CorrectiveAction, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>
                                                </div>




                                                    <div class="row">
                                                        <div class="col-xs-12">
                                                            <div class="form-group">
                                                                <label><i class="fa fa-paperclip" style="color:black;"></i>Incident Photographs: </label><br />
                                                                
                                                                <input type="file" class="filepond" name="FileUpload" id="FileUpload" multiple>
                                                                <input hidden="hidden" id="FileUpload" name="FileUpload" class="hidden" />
                                                            </div>
                                                        </div>

                                                        @if (Model != null)
                                                        {
                                                            if (Model.IncidentPhotographs != null && Model.IncidentPhotographs.Count > 0)
                                                            {
                                                                <input type="hidden" value="Yes" name="testing" id="testing" />
                                                                <div class="col-xs-12">
                                                                    <div class="form-group">
                                                                        <ul class="Attachment">
                                                                            @foreach (var item in Model.IncidentPhotographs)
                                                                            {
                                                                                <li>
                                                                                    <a class="title1" href="~/SafetyInsidentReport/Download/?p=@(item.IDS + item.Extension)&d=@item.PK_ID">@item.FileName</a>
                                                                                    <a href="javascript:void(0);" data-id="@item.IDS" class="deleteItem">X</a>
                                                                                </li>
                                                                            }
                                                                        </ul>
                                                                    </div>
                                                                </div>
                                                            }
                                                            else
                                                            {
                                                                <input type="hidden" value="" name="testing" id="testing" />
                                                                <p style="color:red;text-align:center;font-weight:bold;">File Not Uploaded</p>
                                                            }
                                                        }
                                                        else
                                                        {
                                                            <p style="color:red;text-align:center;font-weight:bold;">There is no attachments !!!</p>
                                                        }
                                                    </div>
                                                   
                                                <div class="row">
                                                    <div class="col-xs-12">
                                                        <div class="form-group">
                                                            <label><i class="fa fa-paperclip" style="color:black;"></i>Lessons Learnt Photographs: </label><br />

                                                            <input type="file" class="filepond" name="FileUpload1" id="FileUpload1" multiple>
                                                            <input hidden="hidden" id="FileUpload1" name="FileUpload1" class="hidden" />
                                                        </div>
                                                    </div>

                                                    @if (Model != null)
                                                    {
                                                        if (Model.LessonsLearntPhotographs != null && Model.LessonsLearntPhotographs.Count > 0)
                                                        {
                                                            <input type="hidden" value="Yes" name="testing" id="testing" />
                                                                <div class="col-xs-12">
                                                                    <div class="form-group">
                                                                        <ul class="Attachment">
                                                                            @foreach (var item in Model.LessonsLearntPhotographs)
                                                                            {
                                                                                <li>
                                                                                    <a class="title1" href="~/SafetyInsidentReport/Download/?p=@(item.IDS + item.Extension)&d=@item.PK_ID">@item.FileName</a>
                                                                                    <a href="javascript:void(0);" data-id="@item.IDS" class="deleteItem">X</a>
                                                                                </li>
                                                                            }
                                                                        </ul>
                                                                    </div>
                                                                </div>
                                                        }
                                                        else
                                                        {
                                                            <input type="hidden" value="" name="testing" id="testing" />
                                                                <p style="color:red;text-align:center;font-weight:bold;">File Not Uploaded</p>
                                                        }
                                                    }
                                                    else
                                                    {
                                                        <p style="color:red;text-align:center;font-weight:bold;">There is no attachments !!!</p>
                                                    }
                                                </div>

                                                <div class="row">
                                                    <div class="col-xs-12">
                                                        <div class="form-group">
                                                            <label><i class="fa fa-paperclip" style="color:black;"></i>Other attachment: </label><br />

                                                            <input type="file" class="filepond" name="FileUpload2" id="FileUpload2" multiple>
                                                            <input hidden="hidden" id="FileUpload2" name="FileUpload2" class="hidden" />
                                                        </div>
                                                    </div>

                                                    @if (Model != null)
                                                    {
                                                        if (Model.OtherAttachment != null && Model.OtherAttachment.Count > 0)
                                                        {
                                                            <input type="hidden" value="Yes" name="testing" id="testing" />
                                                            <div class="col-xs-12">
                                                                <div class="form-group">
                                                                    <ul class="Attachment">
                                                                        @foreach (var item in Model.OtherAttachment)
                                                                        {
                                                                            <li>
                                                                                <a class="title1" href="~/SafetyInsidentReport/Download/?p=@(item.IDS + item.Extension)&d=@item.PK_ID">@item.FileName</a>
                                                                                <a href="javascript:void(0);" data-id="@item.IDS" class="deleteItem">X</a>
                                                                            </li>
                                                                        }
                                                                    </ul>
                                                                </div>
                                                            </div>
                                                        }
                                                        else
                                                        {
                                                            <input type="hidden" value="" name="testing" id="testing" />
                                                            <p style="color:red;text-align:center;font-weight:bold;">File Not Uploaded</p>
                                                        }
                                                    }
                                                    else
                                                    {
                                                        <p style="color:red;text-align:center;font-weight:bold;">There is no attachments !!!</p>
                                                    }
                                                </div>



                                                  
                                                


                                                <div class="row">

                                                    <div class="col-xs-12 col-sm-4">
                                                        <div class="form-group">
                                                            <label>Man-days Lost due to the Incident: </label>
                                                            @Html.TextBoxFor(model => model.MandaysLost, new { @placeholder = "Mandays Lost", @class = "form-control", autocomplete = "off" })
                                                            @Html.ValidationMessageFor(model => model.MandaysLost, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-12 col-sm-4">
                                                        <div class="form-group">
                                                            <label>Risk And Opportunities: </label>
                                                            @Html.CheckBoxFor(model => model.RiskAndOpportunities)
                                                            @Html.ValidationMessageFor(model => model.RiskAndOpportunities, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>

                                                    <div class="col-xs-12 col-sm-4">
                                                        <div class="form-group">
                                                            <label>AIHIRA Reviewed: </label>
                                                            @Html.CheckBoxFor(model => model.AIHIRAReviewed)
                                                            @Html.ValidationMessageFor(model => model.AIHIRAReviewed, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-12 col-sm-4">
                                                        <div class="form-group">
                                                            <label>Share Lessons Learnt with Employees: </label>
                                                            @Html.CheckBoxFor(model => model.ShareLessonsLearnt)
                                                            @Html.ValidationMessageFor(model => model.ShareLessonsLearnt, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-12 col-sm-4">
                                                        <div class="form-group">
                                                            <label>Status </label>
                                                            @Html.DropDownListFor(m => m.Status, new List<SelectListItem>
                                                                                                      {
                                                                                                        new SelectListItem{ Text="Open", Value = "Open" },
                                                                                                        new SelectListItem{ Text="Closed", Value = "Closed" },
                                                                                                        

                                                                                                     }, new { @class = "form-control", @id = "Type" })
                                                            @Html.ValidationMessageFor(model => model.ShareLessonsLearnt, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-12 col-sm-3" style="pointer-events:none;">
                                                        <div class="form-group">
                                                            <label>Form Filled By </label>
                                                            @Html.TextBoxFor(model => model.FormFilledBy, new { @placeholder = "Form Filled By", @class = "form-control", autocomplete = "off" })
                                                            @Html.ValidationMessageFor(model => model.FormFilledBy, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-12 col-sm-3" style="pointer-events:none;">
                                                        <div class="form-group">
                                                            <label>Creation Date </label>
                                                            @Html.TextBoxFor(model => model.CreationDate, new { @placeholder = "Creation Date", @class = "form-control", autocomplete = "off" })
                                                            @Html.ValidationMessageFor(model => model.CreationDate, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-12 col-sm-3" style="pointer-events:none;">
                                                        <div class="form-group">
                                                            <label>Modified by </label>
                                                            @Html.TextBoxFor(model => model.Modifiedby, new { @placeholder = "Modified by", @class = "form-control", autocomplete = "off" })
                                                            @Html.ValidationMessageFor(model => model.Modifiedby, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-12 col-sm-3" style="pointer-events:none;">
                                                        <div class="form-group">
                                                            <label>Modification Date </label>
                                                            @Html.TextBoxFor(model => model.ModificationDate, new { @placeholder = "Modification Date", @class = "form-control", autocomplete = "off" })
                                                            @Html.ValidationMessageFor(model => model.ModificationDate, "", new { @class = "text-danger validation-msg" })
                                                        </div>
                                                    </div>
                                                </div>


                                                
                                                
                                                
                                                

                                                <div class="row">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <div class="form-group">
                                                            <button type="reset" class="btn btn-default insert-form-btn"> Reset </button>
                                                            <button type="submit" class="btn btn-default insert-form-btn"> Save </button>
                                                        </div>
                                                    </div>
                                                </div>


                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<script type="text/javascript" language="javascript" src="~/AllJsAndCss/datatable/js/jquery.dataTables.js"></script>
<script src="~/AllJsAndCss/datatable/js/jquery.dataTables.js"></script>
<script src="~/AllJsAndCss/js/datatable-custom.js"></script>



<!--filepond-->
<!-- Load FilePond library -->
<script src="~/AllJsAndCss/js/filepond.js"></script>

<!-- Turn all file input elements into ponds -->
<script>
    FilePond.parse(document.body);
</script>


<script>
    FilePond.setOptions({
        server: '@Url.Action("TemporaryFilePathDocumentAttachment", "SafetyInsidentReport")'
    });
</script>