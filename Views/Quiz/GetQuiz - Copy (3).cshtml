@model TuvVision.Models.QuizModel
@{
    ViewBag.Title = "GetQuiz";
    Layout = "~/Views/Shared/_TuvVision.cshtml";
    int i = 0;
    int k = 0;
}

@*<style>
    .qn {
    display: none;
}
.qn:first-child {
    display: block;
}
input[type="submit"] {
    display:none;
}
</style>*@
@*@import url(https://fonts.googleapis.com/css?family=Work+Sans:300,600);*@
<script type="text/javascript" src="https://fonts.googleapis.com/css?family=Work+Sans:300,600"></script>
<style>

  

body{
	font-size: 20px;
	font-family: 'Work Sans', sans-serif;
	color: #333;
  font-weight: 300;
  text-align: center;
  background-color: #f8f6f0;
}
h1{
  font-weight: 300;
  margin: 0px;
  padding: 10px;
  font-size: 20px;
  background-color: #444;
  color: #fff;
}
.question{
  font-size: 30px;
  margin-bottom: 10px;
}
.answers {
  margin-bottom: 20px;
  text-align: left;
  display: inline-block;
}
.answers label{
  display: block;
  margin-bottom: 10px;
}
button{
  font-family: 'Work Sans', sans-serif;
	font-size: 22px;
	background-color: #279;
	color: #fff;
	border: 0px;
	border-radius: 3px;
	padding: 20px;
	cursor: pointer;
	margin-bottom: 20px;
}
button:hover{
	background-color: #38a;
}





.slide{
  position: absolute;
  left: 0px;
  top: 0px;
  width: 100%;
  z-index: 1;
  opacity: 0;
  transition: opacity 0.5s;
}
.active-slide{
  opacity: 1;
  z-index: 2;
}
.quiz-container{
  position: relative;
  height: 200px;
  margin-top: 40px;
}
</style>

@using (Html.BeginForm("GetQuiz", "Quiz", FormMethod.Post, new { enctype = "multipart/form-data", @id = "formqz" }))
{
    <div class="main-content3 xs-max-height grey-bg-f3">
        <div class="grey-bg-f3">
            <!--Start of header-->
            <div class="container-fluid">
                <div class="row assignfixedwidth rp-5">

                    <div class="col-xs-12 form-col">
                        <div class="row">
                            <div class="col-md-12 col-sm-12 col-xs-12 text-right">
                                <br />
                                <a href="@Url.Action("TrainingDetails", "TrainingSchedule")" class="btn btn-default insert-form-btn"><i class="fa fa-long-arrow-left"></i> Go Back</a>
                            </div>
                            <br />
                            <br />
                            <div class="col-xs-12">
                                <div class="white-bg section-box-shadow">
                                    <h3 class="form-page-title">Quiz on @ViewBag.TP</h3>
                                    <div class="row">
                                        <div class="col-xs-12 col-sm-offset-1 col-sm-10">
                                            <div class="form-box">
                                                <form>
                                                    <div class="row">
                                                        <div class="col-xs-12 col-sm-4">
                                                            @Html.HiddenFor(model => model.TrainingID)
                                                            @Html.HiddenFor(model => model.QuizID)
                                                        </div>
                                                    </div>

                                                    @*<h3 class="form-page-title">@ViewBag.TrngNm</h3>*@
                                                    <br />
                                                    @{ 
                                                        int QuestionCount = (ViewBag.QuizQuestions as List<TuvVision.Models.QuizQuestion>).Count();
                                                    }
                                                    @*@if (ViewBag.Attandance == "1")
                                                    {*@
                                                        @if (ViewBag.QuizVerify == "NotSubmitted")
                                                        {
                                                            //if (QuestionCount > 0 && ViewBag.QzDate == "True")
                                                            //{
                                                            
                                                                 <div>
                                                                     <div class="row">
                                                                         <div class="col-xs-12 col-sm-12" style="text-align:left;margin-left:18px;">
                                                                             <div class="form-group">
                                                                                 @*<input type="button" id='Previous' value="Previous" onlick="sum_values()" style="background-color: #04AA6D;color: white;display:none;font-family: 'Work Sans', sans-serif;font-size: 22px;background-color: #279;color: #fff;border: 0px;border-radius: 3px;padding: 20px;cursor: pointer;margin-bottom: 20px;">*@
                                                                                 <input type="button" id='Previous' value="Previous" onlick="sum_values()" class="btn btn-primary btn-lg">
                                                                                 
                                                                                 <input type="button" id='next' value="Next" onlick="sum_values()" class="btn btn-primary btn-lg" @*style="background-color: #04AA6D;color: white;font-family: 'Work Sans', sans-serif;font-size: 22px;background-color: #279;color: #fff;border: 0px;border-radius: 3px;padding: 20px;cursor: pointer;margin-bottom: 20px;"*@>

                                                                                 <button type="submit" class="btn btn-primary btn-lg" id="submit" @*style="display:none;background-color: #04AA6D;color: white;display:none;font-family: 'Work Sans', sans-serif;font-size: 22px;background-color: #279;color: #fff;border: 0px;border-radius: 3px;padding: 20px;cursor: pointer;margin-bottom: 20px;"*@> Submit </button>
                                                                             </div>
                                                                         </div>
                                                                     </div>
                                                                     <div class="col-xs-12">
                                                                         <table>
                                                                             @foreach (var item in ViewBag.QuizQuestions as List<TuvVision.Models.QuizQuestion>)
                                                                             {

                                                                                 i = i + 1;
                                                                                 @*<tr>
                                                                                     <th scope="row"> @i &nbsp; @item.TQuestion</th>
                                                                                     @Html.HiddenFor(m => m.QuizQuestion[k].TQuizID, new { Value = item.TQuizID })
                                                                                     @Html.HiddenFor(m => m.QuizQuestion[k].TrainingID, new { Value = item.TrainingID })
                                                                                 </tr>
                                                                                 <tr>
                                                                                     <td>
                                                                                         @if (!string.IsNullOrEmpty(Convert.ToString(item.TOption1)))
                                                                                         {
                                                                                             @Html.RadioButtonFor(m => m.QuizQuestion[k].TOption1, "a")
                                                                                             <span> @item.TOption1 &nbsp;&nbsp;</span>
                                                                                         }
                                                                                         @if (!string.IsNullOrEmpty(Convert.ToString(item.TOption2)))
                                                                                         {
                                                                                             @Html.RadioButtonFor(m => m.QuizQuestion[k].TOption2, "b")
                                                                                             <span> @item.TOption2 &nbsp;&nbsp;</span>
                                                                                         }
                                                                                         @if (!string.IsNullOrEmpty(Convert.ToString(item.TOption3)))
                                                                                         {
                                                                                             @Html.RadioButtonFor(m => m.QuizQuestion[k].TOption3, "c")
                                                                                             <span> @item.TOption3 &nbsp;&nbsp;</span>
                                                                                         }
                                                                                         @if (!string.IsNullOrEmpty(Convert.ToString(item.TOption4)))
                                                                                         {
                                                                                             @Html.RadioButtonFor(m => m.QuizQuestion[k].TOption4, "d")
                                                                                             <span> @item.TOption4 &nbsp;&nbsp;</span>
                                                                                         }

                                                                                     </td>
                                                                                 </tr>*@
                                                                                 <tr><td><br /></td></tr>
                                                                                
                                                                               
                                                                                @*<div class="quiz-container">*@
                                                                                    <div class="questions">
                                                                                        <p style="text-align:left;"> @i &nbsp; @item.TQuestion </p>
                                                                                        @Html.HiddenFor(m => m.QuizQuestion[k].TQuizID, new { Value = item.TQuizID })
                                                                                        @Html.HiddenFor(m => m.QuizQuestion[k].TrainingID, new { Value = item.TrainingID })
                                                                                        @*<form>*@
                                                                                        <li style="text-align:left;">
                                                                                            @if (!string.IsNullOrEmpty(Convert.ToString(item.TOption1)))
                                                                                        {
                                                                                        @Html.RadioButtonFor(m => m.QuizQuestion[k].TOption1, "a", new { name = "abc" })
                                                                                        <span> @item.TOption1 &nbsp;&nbsp;</span>
                                                                                        }
                                                                                        </li>
                                                                                        <li style="text-align:left;">
                                                                                            @if (!string.IsNullOrEmpty(Convert.ToString(item.TOption2)))
                                                                                        {
                                                                                        @Html.RadioButtonFor(m => m.QuizQuestion[k].TOption2, "b", new { name = "abc2" })
                                                                                        <span> @item.TOption2 &nbsp;&nbsp;</span>
                                                                                        }
                                                                                        </li>
                                                                                        <li style="text-align:left;">
                                                                                            @if (!string.IsNullOrEmpty(Convert.ToString(item.TOption3)))
                                                                                        {
                                                                                        @Html.RadioButtonFor(m => m.QuizQuestion[k].TOption3, "c", new { name = "abc3" })
                                                                                        <span> @item.TOption3 &nbsp;&nbsp;</span>
                                                                                        }
                                                                                        </li>
                                                                                        <li style="text-align:left;">
                                                                                            @if (!string.IsNullOrEmpty(Convert.ToString(item.TOption4)))
                                                                                        {
                                                                                        @Html.RadioButtonFor(m => m.QuizQuestion[k].TOption4, "d", new { name = "abc4" })
                                                                                        <span> @item.TOption4 &nbsp;&nbsp;</span>
                                                                                        }
                                                                                        </li>
                                                                                        @*</form>*@
                                                                                    </div>
@*</div>*@
                                                                                    k++;
                                                                                    }
</table>
                                                                     </div>
                                                                 </div>
                                                                @*<h1>Quiz on Important Facts</h1>
                                                                <div class="quiz-container">
                                                                    <div id="quiz"></div>
                                                                </div>
                                                                <button id="previous">Previous Question</button>
                                                                <button id="next">Next Question</button>
                                                                <button id="submit">Submit Quiz</button>
                                                                <div id="results"></div>*@


                                                                @*<div class="row">
                                                                    <div class="col-xs-12 col-sm-12">
                                                                        <div class="form-group">
                                                                            <button type="submit" class="btn btn-default insert-form-btn" id="submit" style="display:none;"> Submit </button>
                                                                        </div>
                                                                    </div>
                                                                </div>*@
                                                            @*}
                                                            else
                                                            {
                                                                if (ViewBag.QzDate == "Expired")
                                                                {
                                                                    <div class="row">
                                                                        <h3 class="form-page-title">Quiz has been expired ... Please reach out to Administrator for further details !</h3>
                                                                    </div>
                                                                }
                                                                else
                                                                {
                                                                    <div class="row">
                                                                        <h3 class="form-page-title">Quiz have not been activated yet ... Stay tuned for further details !</h3>
                                                                    </div>
                                                                }
                                                            }*@
                                                        }
                                                        else
                                                        {
                                                            <div class="row">
                                                                <h3>Congratulations ... You have successfully attempted this Test !</h3>
                                                                <br />
                                                                
                                                            </div>
                                                            if(ViewBag.ResultShow=="Yes")
                                                            { 
                                                            <div class="row">
                                                                <h3>Result: @ViewBag.Percent% </h3>
                                                            </div>
                                                            }
                                                        }


                                                                @*<input type="button" id='Previous' value="Previous" onlick="sum_values()" style="background-color: #04AA6D;color: white;display:none;">
                                                                    <input type="button" id='next' value="Next" onlick="sum_values()" style="background-color: #04AA6D;color: white;">*@




</form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}

@*Working*@



<script>
    $(document).ready(function () {
        debugger
        answers = new Object();
        $('.option').change(function () {
            var answer = ($(this).attr('value'))
            var question = ($(this).attr('name'))
            answers[question] = answer
        })
        var item1 = document.getElementById('questions');

        var totalQuestions = $('.questions').size();
        var currentQuestion = 0;
        
        $questions = $('.questions');
        $questions.hide();
        $($questions.get(currentQuestion)).fadeIn();

        chkFirstQ(currentQuestion)
        $('#next').click(function () {
            debugger;
           
            $($questions.get(currentQuestion)).fadeOut(function () {
                currentQuestion = currentQuestion + 1;
                if (currentQuestion == totalQuestions) {
                    var result = sum_values()
                    $("#next").hide();
                    $("#submit").show();
                    //do stuff with the result
                    chkFirstQ(currentQuestion)
                } else {
                    $("#next").show();
                    $("#submit").hide();
                    chkFirstQ(currentQuestion)
                    
                    $($questions.get(currentQuestion)).fadeIn();
                }
            });

        });

        $('#submit').click(function () {
            debugger;
            var getSelectedValue = document.querySelector('input[name="abc"]:checked');

        })
        

        $('#Previous').click(function () {
            debugger;
            $($questions.get(currentQuestion)).fadeOut(function () {
                currentQuestion = currentQuestion - 1;
                if (currentQuestion == totalQuestions) {
                    var result = sum_values()
                    $("#next").hide();
                    $("#submit").show();
                    
                    //do stuff with the result
                    chkFirstQ(currentQuestion)
                } else {
                    $("#submit").hide();
                    $("#next").show();
                    chkFirstQ(currentQuestion)
                    
                    $($questions.get(currentQuestion)).fadeIn();
                }
            });

        });



    });


    function chkFirstQ(currentQuestion) {
        debugger;
        
            if (currentQuestion == "0") {
                $("#Previous").hide();
            }
            else {
                $("#Previous").show();
            }


            var totalQuestions1 = $('.questions').size();
            if (currentQuestion + 1 == totalQuestions1) {
                $("#submit").show();
                $("#next").hide();
            }
            else {
                $("#submit").hide();
                $("#next").show();
            }
        
    }


    //    var q = 1;
    //    $("#next").click(function () {
    //        debugger;
    //        PreB = PreB + 1;

    //        q = q + 1;
    //        GetQCount(q)
            

    //        var a = PreB;
    //        if (a == "1") {
    //            $("#Previous").hide();
    //        }
    //        else {
    //            $("#Previous").show();
    //        }


    //        var current = $(".questions:visible"),
    //            total = $(".questions").length,
    //            last = $(".questions:last");
    //        $(current).next().show();
    //        $(current).hide();
    //        if ($(current).next().is(last)) {
    //            $("#next").hide();
    //            $("#btnSubmit").show();
    //        }
    //    });

        
    //    $('#Previous').click(function () {
    //        debugger;
    //        q = q - 1;
    //        GetQCountOnPre(q)

          
    //        $($questions.get(currentQuestion)).fadeOut();
    //    });









    //});


    function sum_values() {
        var the_sum = 0;
        for (questions in answers) {
            the_sum = the_sum + parseInt(answers[question])
        }
        return the_sum
    }


    function GetQCount(q) {
        debugger;

        if (q == 1) {
            $("#Previous").hide();
        }
        else
        {
            $("#Previous").show();
        }
    }
    function GetQCountOnPre(q) {
        debugger;
        if (q == 1) {
            $("#Previous").hide();
            $("#submit").hide();
            $("#next").show();
        }
        else {
            $("#Previous").show();
        }
    }



    //$('#Previous').click(function (currentQuestion) {
    //    debugger;
    //    PreB = PreB - 1;
    //    $($questions.get(currentQuestion)).fadeOut(function () {
    //        currentQuestion = currentQuestion - 1;
    //        if (currentQuestion == totalQuestions) {
    //            $("#btnSubmit").show();
    //            $("#next").hide();
    //            HideShowPrevious()
    //        } else {
    //            $("#btnSubmit").hide();

    //            $($questions.get(currentQuestion)).fadeIn();
    //            HideShowPrevious()


    //        }
    //    });

    //});
</script>


@*
    <script>
        debugger;
        (function () {
            debugger;
            // Functions
            function buildQuiz() {
                // variable to store the HTML output
                const output = [];

                // for each question...
                myQuestions.forEach(
                  (currentQuestion, questionNumber) => {

                      // variable to store the list of possible answers
                      const answers = [];

                      // and for each available answer...
                      for (letter in currentQuestion.answers) {

                          // ...add an HTML radio button
                          answers.push(
                            `<label>
                  <input type="radio" name="question${questionNumber}" value="${letter}">
                  ${letter} :
                  ${currentQuestion.answers[letter]}
                </label>`
                          );
                      }

                      // add this question and its answers to the output
                      output.push(
                        `<div class="slide">
                <div class="question"> ${currentQuestion.question} </div>
                <div class="answers"> ${answers.join("")} </div>
              </div>`
                      );
                  }
                );

                // finally combine our output list into one string of HTML and put it on the page
                quizContainer.innerHTML = output.join('');
            }

            function showResults() {

                // gather answer containers from our quiz
                const answerContainers = quizContainer.querySelectorAll('.answers');

                // keep track of user's answers
                let numCorrect = 0;

                // for each question...
                myQuestions.forEach((currentQuestion, questionNumber) => {

                    // find selected answer
                    const answerContainer = answerContainers[questionNumber];
                    const selector = `input[name=question${questionNumber}]:checked`;
                    const userAnswer = (answerContainer.querySelector(selector) || {}).value;

                    // if answer is correct
                    if (userAnswer === currentQuestion.correctAnswer) {
                        // add to the number of correct answers
                        numCorrect++;

                        // color the answers green
                        answerContainers[questionNumber].style.color = 'lightgreen';
                    }
                        // if answer is wrong or blank
                    else {
                        // color the answers red
                        answerContainers[questionNumber].style.color = 'red';
                    }
                });

                // show number of correct answers out of total
                resultsContainer.innerHTML = `${numCorrect} out of ${myQuestions.length}`;
            }

            function showSlide(n) {
                debugger;
                slides[currentSlide].classList.remove('active-slide');
                slides[n].classList.add('active-slide');
                currentSlide = n;
                if (currentSlide === 0) {
                    previousButton.style.display = 'none';
                }
                else {
                    previousButton.style.display = 'inline-block';
                }
                if (currentSlide === slides.length - 1) {
                    nextButton.style.display = 'none';
                    submitButton.style.display = 'inline-block';
                }
                else {
                    nextButton.style.display = 'inline-block';
                    submitButton.style.display = 'none';
                }
            }

            function showNextSlide() {
                debugger;
                showSlide(currentSlide + 1);
            }

            function showPreviousSlide() {
                showSlide(currentSlide - 1);
            }

            // Variables
            const quizContainer = document.getElementById('quiz');
            const resultsContainer = document.getElementById('results');
            const submitButton = document.getElementById('submit');
            const myQuestions = [
              {
                  question: "Who invented JavaScript?",
                  answers: {
                      a: "Douglas Crockford",
                      b: "Sheryl Sandberg",
                      c: "Brendan Eich"
                  },
                  correctAnswer: "c"
              },
              {
                  question: "Which one of these is a JavaScript package manager?",
                  answers: {
                      a: "Node.js",
                      b: "TypeScript",
                      c: "npm"
                  },
                  correctAnswer: "c"
              },
              {
                  question: "Which tool can you use to ensure code quality?",
                  answers: {
                      a: "Angular",
                      b: "jQuery",
                      c: "RequireJS",
                      d: "ESLint"
                  },
                  correctAnswer: "d"
              }
            ];

            // Kick things off
            buildQuiz();

            // Pagination
            const previousButton = document.getElementById("previous");
            const nextButton = document.getElementById("next");
            const slides = document.querySelectorAll(".slide");
            let currentSlide = 0;

            // Show the first slide
            showSlide(currentSlide);

            // Event listeners
            submitButton.addEventListener('click', showResults);
            previousButton.addEventListener("click", showPreviousSlide);
            nextButton.addEventListener("click", showNextSlide);
        })();

    </script>

    *@



    @*<script>
        $("#next").click(function () {
            debugger;
            var current = $(".qn:visible"),
                total = $(".qn").length,
                last = $(".qn:last");
            $(current).next().show();
            $(current).hide();
            if ($(current).next().is(last)) {
                $("#next").hide();
                //$("input[type='submit']").show();
            }
        });

    </script>*@



@*<script>
    $("#btnUserSave1").on('click', function (event)
    {

        var TrainingDetails =
     {
         PK_TrainingScheduleId: PK_TrainingScheduleId,
         TrainingName: TrainingName,
        
     }

        $.ajax({
            type: 'POST',
            url: '@Url.Action("ScheduleTraining", "TrainingSchedule")',
            dataType: 'json',
            Async: false,
            data: JSON.stringify({ TSM: TrainingDetails, "DArray": DArray, }),
            enctype: "multipart/form-data",
            contentType: "application/json; charset=utf-8",
            success: function (response) {

                if (response.result == 'Redirect') {
                    alert("Training Details has been Save successfully!!!")
                    window.location = response.url;
                }

                if (response.result == 'Update') {
                    alert("Training Details has been updated successfully!!!")
                    window.location = response.url;
                }
            }
        })


    });

</script>*@

