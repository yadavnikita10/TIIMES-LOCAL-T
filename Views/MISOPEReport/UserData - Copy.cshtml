@model TuvVision.Models.ProfileUser
@using NonFactors.Mvc.Grid;
@using System.Web.Mvc;


@{
    ViewBag.Title = "UserDashBoard";
    Layout = "~/Views/Shared/_TuvVision.cshtml";
}
@*Ashwini Scripts here for datatable starts here*@
<script type="text/javascript" language="javascript" src="~/AllJsAndCss/datatable/js/jquery.dataTables.js"></script>

<!--export to excel-->
@*<script type="text/javascript" language="javascript" src="~/AllJsAndCss/js/dataTables.buttons.min.js"></script>
    <script type="text/javascript" language="javascript" src="~/AllJsAndCss/js/jszip.min.js"></script>
    <script type="text/javascript" language="javascript" src="~/AllJsAndCss/js/buttons.html5.min.js"></script>*@
<script src="~/AllJsAndCss/js/datatable-custom.js"></script>


@using (Html.BeginForm())
{
    <!--Start of header-->
    <!--Start of main content 3-->
    <div class="main-content3 xs-max-height">

        <!--Start of header-->
        <div class="container-fluid">
            <div class="row assignfixedwidth rp-15">

                <div class="col-xs-12">
                    <h3 class="dynamic-page-title dynamic-page-title-2  text-left">User Data</h3>

                    <button type="button" id="a" value="ExportToExcel" class="btn btn-info dynamic-function-btn dynamic-function-btn-2" onclick="location.href='@Url.Action("ExportUserData","MISOPEReport")'">
                        Export To Excel
                    </button>
                </div><!-- /.col -->

                <div class="col-xs-12">
                    <hr class="custom-hr">
                </div><!-- /.col -->
                <!--Table was here-->

            </div><!-- /.row -->





            <div class="col-xs-12" id="divHistory" style="overflow:auto;width:99%;height:600px;">
                <table class="display dataTable no-footer" id="example1">

                    <thead>
                        <tr>
                            <th>FirstName</th>
                            <th>LastName</th>
                            <th>DateOfJoining</th>
                            <th>Branch</th>
                            <th>Employement Category</th>
                            <th>Employee Code</th>
                            <th>Designation</th>
                            <th>Tuv Email Id</th>
                            <th>Date Of Birth</th>
                            <th>PAN No</th>
                            <th>Mobile No</th>
                            <th>Gender</th>
                            <th>Experience In Month</th>
                            <th>Total year of Exprience</th>
                            <th>TUVI Stamp No</th>
                            <th>Qualification</th>
                            <th>Proffesional Certificates</th>

                            <th>Photo</th>
                            <th>Signature</th>
                            <th>CV</th>
                            <th>PAN Card</th>
                            <th>Eye Test Report</th>
                            <th>FMR</th>


                        </tr>
                    </thead>

                    <tbody>



                        @foreach (var item in ViewData["UserData"] as IEnumerable<TuvVision.Models.ProfileUser>)
                        {
                            <tr>
                                <td>@item.FirstName</td>
                                <td>@item.LastName</td>
                                <td>@item.DateOfJoining</td>
                                <td>@item.Branch</td>
                                <td>@item.EmployementCategory</td>
                                <td>@item.EmployeeCode</td>
                                <td>@item.Designation</td>
                                <td>@item.TuvEmailId</td>
                                <td>@item.DOB</td>
                                <td>@item.PanNo</td>
                                <td>@item.MobileNo</td>
                                <td>@item.Gender</td>
                                <td>@item.ExperienceInMonth</td>
                                <td>@item.TotalyearofExprience</td>
                                <td>@item.TUVIStampNo</td>
                                <td>@item.Qualification</td>
                                <td>@item.ProfCertificates</td>



                                @*@if (item.Photo != null && item.Photo != "")*@
@if (item.Photo.Length != 0 )
{
    var attach = item.Photo.Split('|');
                                    <td>
                                        <li>
                                            <a class="title" href="@Url.Action("Download", "MISOPEReport", new { @d = attach[1].ToString()  })">@attach[0].ToString()</a>
                                        </li>
                                    </td>
                                }
                                else
                                {
                                    <td>&nbsp;</td>
                                }

                                @if (item.Signature != null && item.Signature != "")
                                {
                                    var attach1 = item.Signature.Split('|');
                                    <td>
                                        <li>
                                            <a class="title" href="@Url.Action("Download", "MISOPEReport", new { @d = attach1[1].ToString()  })">@attach1[0].ToString()</a>
                                        </li>
                                    </td>
                                }
                                else
                                {
                                    <td>&nbsp;</td>
                                }

                                @if (item.CV != null && item.CV != "")
                                {
                                    var attach2 = item.CV.Split('|');
                                    <td>
                                        <li>
                                            <a class="title" href="@Url.Action("Download", "MISOPEReport", new { @d = attach2[1].ToString()  })">@attach2[0].ToString()</a>
                                        </li>
                                    </td>
                                }
                                else
                                {
                                    <td>&nbsp;</td>
                                }

                                @if (item.PAN != null && item.PAN != "")
                                {
                                    var attach3 = item.PAN.Split('|');
                                    <td>
                                        <li>
                                            <a class="title" href="@Url.Action("Download", "MISOPEReport", new { @d = attach3[1].ToString()  })">@attach3[0].ToString()</a>
                                        </li>
                                    </td>
                                }
                                else
                                {
                                    <td>&nbsp;</td>
                                }

                                @if (item.ETR != null && item.ETR != "")
                                {
                                    var attach4 = item.ETR.Split('|');
                                    <td>
                                        <li>
                                            <a class="title" href="@Url.Action("Download", "MISOPEReport", new { @d = attach4[1].ToString()  })">@attach4[0].ToString()</a>
                                        </li>
                                    </td>
                                }
                                else
                                {
                                    <td>&nbsp;</td>
                                }

                                @if (item.FMR != null && item.FMR != "")
                                {
                                    var attach5 = item.FMR.Split('|');
                                    <td>
                                        <li>
                                            <a class="title" href="@Url.Action("Download", "MISOPEReport", new { @d = attach5[1].ToString()  })">@attach5[0].ToString()</a>
                                        </li>
                                    </td>
                                }
                                else
                                {
                                    <td>&nbsp;</td>
                                }
                            </tr>
                        }

                    </tbody>

                </table>
            </div>

        </div><!-- /.container-fluid -->
        <!--End of header-->
    </div>
  <!--End of main content 3-->
}


<script>
    var CustomTextFilter = (function (base) {
        MvcGridExtends(CustomTextFilter, base);

        function CustomTextFilter(column) {
            base.call(this, column);

            this.methods = ['contains'];
            column.grid.lang.custom = { contains: 'Contains' };
        }

        // Other extension points can be found at MvcGridFilter declaration

        return CustomTextFilter;
    })(MvcGridFilter);

    new MvcGrid(document.querySelector('.mvc-grid'), {
        filters: {
            'custom': CustomTextFilter
        }
    });
</script>

<script src="~/Scripts/MvcGrid/jquery.quicksearch.js"></script>
<script src="~/Scripts/MvcGrid/dataTables.fixedColumns.min.js"></script>

<script>
           [].forEach.call(document.getElementsByClassName('mvc-grid'), function (element) {
               new MvcGrid(element);
           });

           $('.mvc-grid-value').each(function (i)
           {
               var j = i + 2 ;
               $(this).quicksearch("#gridMapping tr:not(:has(th))",
               {

                   'testQuery': function (query, txt, row)
                   {

                       return $(row).children(":eq(" + j + ")").text().toLowerCase().indexOf(query[0].toLowerCase()) != -1;
                   }
               });
           });
</script>
