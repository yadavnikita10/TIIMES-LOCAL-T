@model TuvVision.Models.NonInspectionActivity
@{
    ViewBag.Title = "UpdateNonInspectionActivity";
    Layout = "~/Views/Shared/_TuvVision.cshtml";
}

@using (Html.BeginForm("UpdateNonInspectionActivity", "Calender", FormMethod.Post, new { enctype = "multipart/form-data", @id = "form1" }))
{
    <div class="main-content3 xs-max-height grey-bg-f3">
        <div class="grey-bg-f3">
            <!--Start of header-->
            <div class="container-fluid">
                <div class="row assignfixedwidth rp-5">

                    <div class="col-xs-12 form-col">
                        <div class="col-xs-12 text-right">
                            <a href="@Url.Action("Calender","Calender")" class="btn btn-info dynamic-function-btn"><i class="fa fa-long-arrow-left"></i> Go Back</a>
                        </div>
                        <div class="row">
                            <div class="col-xs-12">
                                <div class="white-bg section-box-shadow">
                                    <h3 class="form-page-title">Update Non Inspection Activity</h3>
                                    <div class="row">
                                        <div class="col-xs-12 col-sm-offset-1 col-sm-10">
                                            <div class="form-box">
                                                <form>
                                                    <div class="row">
                                                        <div class="col-xs-12 col-sm-4">
                                                            @Html.HiddenFor(model => model.Id)
                                                            </div>
                                                        </div>
                                                    

                                                    <div class="row">
                                                                <div class="col-xs-12 col-sm-4">
                                                                    <div class="form-group">
                                                                        <label>Activity Type:</label>
                                                                        @Html.DropDownListFor(m => m.ActivityType, new List<SelectListItem>
                                                                     {
                                                                     new SelectListItem{ Text="---SELECT---", Value = "" },
                                                                     new SelectListItem{ Text="Onsite marketing", Value = "Onsite marketing" },
                                                                     new SelectListItem{ Text="Offsite Marketing", Value = "Offsite Marketing" },
                                                                     new SelectListItem{ Text="Self  Study", Value = "Self  Study" },
                                                                     new SelectListItem{ Text="Document reviewed / IRN-VR issued offsite", Value = "Document reviewed / IRN-VR issued offsite" },
                                                                     new SelectListItem{ Text="Inspection co – ordination", Value = "Inspection co – ordination" },
                                                                     new SelectListItem{ Text="Documentation / Record keeping", Value = "Documentation / Record keeping" },
                                                                     new SelectListItem{ Text="Privilege Leave", Value = "Privilege Leave" },
                                                                     new SelectListItem{ Text="Casual Leave", Value = "Casual Leave" },
                                                                     new SelectListItem{ Text="Sick Leave", Value = "Sick Leave" },
                                                                     new SelectListItem{ Text="Training inhouse", Value = "Training inhouse" },
                                                                     new SelectListItem{ Text="Training – external", Value = "Training – external" },
                                                                     new SelectListItem{ Text="QA activity / Monitoring – on site", Value = "QA activity / Monitoring – on site" },
                                                                     new SelectListItem{ Text="QA activity / Monitoring – off site", Value = "QA activity / Monitoring – off site" },
                                                                     new SelectListItem{ Text="Non – clearable activities", Value = "Non – clearable activities" },
                                                                     new SelectListItem{ Text="Office work", Value = "Office work" },
                                                                     new SelectListItem{ Text="Inspection Activity", Value = "Inspection Activity" },
                                                                     
                                                                     new SelectListItem{ Text="Client entertainment", Value = "Client entertainment" }
                                                                     },

                                                                     new { @class = "form-control", @id = "PT" })
                                                                        @Html.ValidationMessageFor(m => m.ActivityType, "", new { @class = "text-danger validation-msg" })
                                                                    </div>
                                                                </div>
                                                                <div class="col-xs-12 col-sm-4">
                                                                    <div class="form-group">
                                                                        <label>Location:</label>
                                                                        @Html.TextBoxFor(model => model.Location, new { @placeholder = "Location Here", @class = "form-control" })
                                                                        @Html.ValidationMessageFor(model => model.Location, "", new { @class = "text-danger validation-msg" })
                                                                    </div>
                                                                </div>
                                                                <div class="col-xs-12 col-sm-4">
                                                                    <div class="form-group">
                                                                        <label>Date:</label>
                                                                        @Html.TextBoxFor(model => model.DateSE, "{0:dd MMM yyyy}", new { @placeholder = "Date", @class = "form-control form-control-custom StartDate", autocomplete = "off" })
                                                                        @Html.ValidationMessageFor(model => model.DateSE, "", new { @class = "text-danger validation-msg" })
                                                                    </div>
                                                                </div>
                                                               
                                                            </div>


                                                    <div class="row">

                                                        @*<div class="col-xs-12 col-sm-4">
                                                            <div class="form-group">
                                                                <label>Start Date:</label>
                                                                
                                                                @Html.TextBoxFor(model => model.StartDate, "{0:dd MMM yyyy}", htmlAttributes: new { placeholder = "Select Start Date", @class = "form-control form-control-custom StartDate", autocomplete = "off" })
                                                                @Html.ValidationMessageFor(model => model.StartDate, "", new { @class = "text-danger validation-msg" })
                                                            </div>
                                                        </div>
                                                        <div class="col-xs-12 col-sm-4">
                                                            <div class="form-group">
                                                                <label>End Date:</label>
                                                                @Html.TextBoxFor(model => model.EndDate, "{0:dd MMM yyyy}", new { @placeholder = "End Date", @class = "form-control form-control-custom EndDate", autocomplete = "off" })
                                                                @Html.ValidationMessageFor(model => model.EndDate, "", new { @class = "text-danger validation-msg" })
                                                            </div>
                                                        </div>*@
                                                        

                                                        <div class="col-xs-12 col-sm-4">
                                                            <div class="form-group">
                                                                <label>Travel Time (In hours):</label>
                                                                @Html.TextBoxFor(model => model.TravelTime, htmlAttributes: new { placeholder = "Travel Time", @class = "form-control", autocomplete = "off", @OnKeyPress = "return isNumber(event)" })
                                                                @Html.ValidationMessageFor(model => model.TravelTime, "", new { @class = "text-danger validation-msg" })
                                                            </div>
                                                        </div>
                                                        <div class="col-xs-12 col-sm-4">
                                                            <div class="form-group">
                                                                <label>Office Time (In hours):</label>
                                                                @Html.TextBoxFor(model => model.EndTime, htmlAttributes: new { placeholder = "Office Time", @class = "form-control", autocomplete = "off", @OnKeyPress = "return isNumber(event)"})
                                                                @Html.ValidationMessageFor(model => model.EndTime, "", new { @class = "text-danger validation-msg" })
                                                            </div>
                                                        </div>
                                                        <div class="col-xs-12 col-sm-4">
                                                            <div class="form-group">
                                                                <label>OD Time (In hours):</label>

                                                                @Html.TextBoxFor(model => model.ODTime, htmlAttributes: new { placeholder = "Outdoor Time", @class = "form-control", autocomplete = "off", @OnKeyPress = "return isNumber(event)" })
                                                                @Html.ValidationMessageFor(model => model.ODTime, "", new { @class = "text-danger validation-msg" })
                                                            </div>
                                                        </div>
                                                    </div>

                                                    
                                                    <div class="row">
                                                        <div class="col-xs-12 col-sm-4">
                                                            <div class="form-group">
                                                                <label>Service Code:</label>
                                                                @if (ViewBag.SubCatlist != null)
                                                                {
                                                                    @Html.DropDownListFor(m => m.ServiceCode, ViewBag.SubCatlist as IEnumerable<SelectListItem>, "--Select Cost center--", new { @class = "form-control", @id = "Pk_CC_Id", })
                                                                    @Html.ValidationMessageFor(model => model.ServiceCode, "", new { @class = "text-danger validation-msg" })
                                                                }
                                                            </div>
                                                        </div>                                                            
                                                        <div class="col-xs-12 col-sm-4">
                                                            <div class="form-group">
                                                                <label>Sub Job Number:</label>

                                                                @Html.TextBoxFor(model => model.JobNumber, htmlAttributes: new { placeholder = "Sub Job Number", @class = "form-control", autocomplete = "off" })
                                                                @Html.ValidationMessageFor(model => model.JobNumber, "", new { @class = "text-danger validation-msg" })
                                                            </div>
                                                        </div>
                                                        <div class="col-xs-12 col-sm-4">
                                                            <div class="form-group">
                                                                <label>Description:</label>
                                                                @Html.TextAreaFor(model => model.Description, htmlAttributes: new { placeholder = "Description", @class = "form-control form-control-custom ", autocomplete = "off" })
                                                                @Html.ValidationMessageFor(model => model.Description, "", new { @class = "text-danger validation-msg" })
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-xs-12 col-sm-12">
                                                            <div class="form-group">
                                                                <label>Attachment</label>
                                                                <input type="file" class="inputupload" name="Image" id="img_Banner" multiple="multiple" />

                                                                @Html.HiddenFor(m => m.Attachment)
                                                                @if (Model != null && Model.Attachment != null && Model.Attachment != "")
                                                                {
                                                                    string[] words = (Model.Attachment).Split(',');
                                                                    for (int j = 1; j < words.Count(); j++)
                                                                    {
                                                                        <a target="_blank" href="@Url.Content("~/NonInspectionActivityDocument/" + words[j-1])">
                                                                            @*<img src="~/PDF-Icon.png" width="50" height="50" />*@
                                                                            <span>@words[j-1].ToString()</span>
                                                                        </a>
                                                                        @*<img src="@Url.Content("~/Content/JobDocument/" + words[j-1])" width="50" height="50" />*@
                                                                    }
                                                                }
                                                            </div>
                                                        </div>
                                                    </div>



                                                    <div class="row">
                                                        
                                                        <div class="col-xs-12 col-sm-4">

                                                            <div class="form-group">
                                                                       
                                                                <button type="submit" class="btn btn-default insert-form-btn" id="btnAddFl"> Update </button>
                                                                <button type="button" class="btn btn-default insert-form-btn" id="ddlInspectionLocation"> Expense</button>
                                                                            
                                                                       
                                                            </div>
                                                        </div>
                                                       
                                                    </div>
                                                     <!-- The Modal -->
                                                            <div class="modal" id="myModal">
                                                                <div class="modal-dialog">
                                                                    <div class="modal-content">

                                                                       
                                                                        <div class="modal-header">
                                                                            <button type="button" class="close NO" data-dismiss="modal">&times;</button>
                                                                        </div>
                                                                        <div class="modal-body">
                                                                            Do you want to Add Expense and Trip Segment
                                                                        </div>

                                                                        <!-- Modal footer -->
                                                                        <div class="modal-footer">
                                                                            @*<a href="@Url.Action("VisitReportForm", "VisitReport", new {@PK_Call_ID = Model.PK_Call_ID })" class="btn btn-danger" style="background-color:green;" title="Edit">Yes</a>*@
                                                                            @*<a href="@Url.Action("CreateExpenseItem", "ExpenseItem", new { FKId = Model.PK_IVR_ID,Type="VSR" })" class="btn btn-danger" style="background-color:green;" title="Edit">Add Expense</a>
                                                                            <a href="@Url.Action("CreateTripSegment", "TripSegment", new { FKId = Model.PK_IVR_ID,Type="VSR" })" class="btn btn-danger" style="background-color:green;" title="Edit">Add Trip Segment</a>*@

                                                                            <a href="@Url.Action("CreateExpenseItem", "ExpenseItem", new { FKId = Model.Id,Type="NIA" })" class="btn btn-danger" style="background-color:green;" title="Edit">Add Expense</a>
                                                                            <a href="@Url.Action("CreateTripSegment", "TripSegment", new { FKId = Model.Id,Type="NIA" })" class="btn btn-danger" style="background-color:green;" title="Edit">Add Trip Segment</a>

                                                                            <button type="button" class="btn btn-danger NO" data-dismiss="modal">No</button>
                                                                        </div>

                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!--End The Modal -->


                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}

<script type="text/javascript" language="javascript" src="~/AllJsAndCss/datatable/js/jquery.dataTables.js"></script>

<!--export to excel-->
<script type="text/javascript" language="javascript" src="~/AllJsAndCss/js/dataTables.buttons.min.js"></script>
<script type="text/javascript" language="javascript" src="~/AllJsAndCss/js/jszip.min.js"></script>
<script type="text/javascript" language="javascript" src="~/AllJsAndCss/js/buttons.html5.min.js"></script>
<script src="~/AllJsAndCss/js/datatable-custom2.js"></script>


<script>
    $("#btnAddFl").click(function myfunction() {
        if (validateform() == false) {
            return false;
        }
        else {
            $("#form1").submit();
        }
    });
    function validateform() {
        debugger;

        var STDate = $("#DateSE").val();
        
        var JN = $("#JobNumber").val();

      /*  if ($("#ServiceCode Option:selected").val() == "" || $("#ServiceCode Option:selected").val() == null) {
            alert("Please select any Service Code !");
            $("#ServiceCode").focus()
            return false;
        }*/
        
        if (STDate == "" || STDate == null) {
            alert("Please select Activity Date !");
            $("#DateSE").focus()
            return false;
        }
        
      /*  if (JN == "" || JN == null) {
            alert("Please Enter Sub Job Number  !");
            $("#JobNumber").focus()
            return false;
        }*/
        //alert($("#PT Option:selected").val());
        if (($("#PT Option:selected").val() == "QA activity / Monitoring – on site") && (JN == "" || JN == null)) {
            alert("Please Enter Sub Job Number !");
            $("#JobNumber").focus()
            return false;
        }
    }
</script>
<script>
        function isNumber(evt) {
            evt = (evt) ? evt : window.event;
            var charCode = (evt.which) ? evt.which : evt.keyCode;


            if (charCode > 31 && (charCode < 48 || charCode > 57)) {
                return false;
            }
            return true;
        }
</script>
<script>
    $(document).ready(function () {
        $("#JobNumber").change(function () {
            alert(123);
                
                var JobNoAS = $("#JobNumber").val();
                $.post("@Url.Action("ValidateJob", "NonInspectionActivity")",
                    {
                        JobNo: $("#JobNumber").val()
                    },
                    function (data) {
                        if (data == 0) {
                            alert("Job No not exist !");
                            $("#JobNumber").val("");
                            $("#JobNumber").focus();
                        }
                    }
                    );
            //}
        })
    });
</script>






@*...Calender Control...*@
<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
<script src="//code.jquery.com/jquery-1.10.2.js"></script>
<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>

@*<script>

    $(document).ready(function () {
        $("#StartDate").datepicker();
    });

</script>
<script>

    $(document).ready(function () {
        $("#EndDate").datepicker();
    });

</script>
<script>
    $(document).ready(function () {
        $("#StartDate").datepicker({

            dateFormat: "dd-mm-yy"

        });
    });
</script>*@

@*Time Picker*@
<link rel="stylesheet" href="https://code.jquery.com/ui/1.11.3/themes/smoothness/jquery-ui.css" type="text/css" />
<script src="https://code.jquery.com/jquery-2.2.2.js"></script>
<script src="https://code.jquery.com/ui/1.11.3/jquery-ui.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-timepicker/1.8.1/jquery.timepicker.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-timepicker/1.8.1/jquery.timepicker.min.css" type="text/css" />


@*<script language="javascript" type="text/javascript">
    $(document).ready(function () {

        $('#StartTime').timepicker();
        $('#EndTime').timepicker();
    });
</script>*@

<script>
    $(document).ready(function () {
        $('#ddlInspectionLocation').on('click', function () {
                $('#myModal').show();
        });
    });
</script>

<script>
    $(document).ready(function () {
        $('.NO').click('change', function () {

            $('#myModal').hide();
        });
    });
</script>